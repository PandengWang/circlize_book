<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Make fun of the package | Circular Visualization in R</title>
  <meta name="description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Make fun of the package | Circular Visualization in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/jokergoo/circlize-book/book" />
  <meta property="og:image" content="https://bookdown.org/jokergoo/circlize-book/book/images/circlize_cover.jpg" />
  <meta property="og:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="github-repo" content="jokergoo/circlize_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Make fun of the package | Circular Visualization in R" />
  
  <meta name="twitter:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="twitter:image" content="https://bookdown.org/jokergoo/circlize-book/book/images/circlize_cover.jpg" />

<meta name="author" content="Zuguang Gu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-complex-example-of-chord-diagram.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Circular Visualization in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="part"><span><b>I General Functionality</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#principle-of-design"><i class="fa fa-check"></i><b>1.1</b> Principle of design</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-qiuck-glance"><i class="fa fa-check"></i><b>1.2</b> A quick glance</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="circular-layout.html"><a href="circular-layout.html"><i class="fa fa-check"></i><b>2</b> Circular layout</a>
<ul>
<li class="chapter" data-level="2.1" data-path="circular-layout.html"><a href="circular-layout.html#coordinate-transformation"><i class="fa fa-check"></i><b>2.1</b> Coordinate transformation</a></li>
<li class="chapter" data-level="2.2" data-path="circular-layout.html"><a href="circular-layout.html#rules-for-making-the-circular-plot"><i class="fa fa-check"></i><b>2.2</b> Rules for making the circular plot</a></li>
<li class="chapter" data-level="2.3" data-path="circular-layout.html"><a href="circular-layout.html#sectors-and-tracks"><i class="fa fa-check"></i><b>2.3</b> Sectors and tracks</a></li>
<li class="chapter" data-level="2.4" data-path="circular-layout.html"><a href="circular-layout.html#graphic-parameters"><i class="fa fa-check"></i><b>2.4</b> Graphic parameters</a></li>
<li class="chapter" data-level="2.5" data-path="circular-layout.html"><a href="circular-layout.html#create-plotting-regions"><i class="fa fa-check"></i><b>2.5</b> Create plotting regions</a></li>
<li class="chapter" data-level="2.6" data-path="circular-layout.html"><a href="circular-layout.html#update-plotting-regions"><i class="fa fa-check"></i><b>2.6</b> Update plotting regions</a></li>
<li class="chapter" data-level="2.7" data-path="circular-layout.html"><a href="circular-layout.html#panel-fun"><i class="fa fa-check"></i><b>2.7</b> <code>panel.fun</code> argument</a></li>
<li class="chapter" data-level="2.8" data-path="circular-layout.html"><a href="circular-layout.html#other-utilities"><i class="fa fa-check"></i><b>2.8</b> Other utilities</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="circular-layout.html"><a href="circular-layout.html#circlize_and_reverse_circlize"><i class="fa fa-check"></i><b>2.8.1</b> <code>circlize()</code> and <code>reverse.circlize()</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="circular-layout.html"><a href="circular-layout.html#convert-functions"><i class="fa fa-check"></i><b>2.8.2</b> Absolute units</a></li>
<li class="chapter" data-level="2.8.3" data-path="circular-layout.html"><a href="circular-layout.html#circos-info-and-circos-clear"><i class="fa fa-check"></i><b>2.8.3</b> <code>circos.info()</code> and <code>circos.clear()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="circular-layout.html"><a href="circular-layout.html#set-gaps-between-tracks"><i class="fa fa-check"></i><b>2.9</b> Set gaps between tracks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>3</b> Graphics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="graphics.html"><a href="graphics.html#setting-colors"><i class="fa fa-check"></i><b>3.1</b> Setting colors</a></li>
<li class="chapter" data-level="3.2" data-path="graphics.html"><a href="graphics.html#points"><i class="fa fa-check"></i><b>3.2</b> Points</a></li>
<li class="chapter" data-level="3.3" data-path="graphics.html"><a href="graphics.html#lines"><i class="fa fa-check"></i><b>3.3</b> Lines</a></li>
<li class="chapter" data-level="3.4" data-path="graphics.html"><a href="graphics.html#segments"><i class="fa fa-check"></i><b>3.4</b> Segments</a></li>
<li class="chapter" data-level="3.5" data-path="graphics.html"><a href="graphics.html#text"><i class="fa fa-check"></i><b>3.5</b> Text</a></li>
<li class="chapter" data-level="3.6" data-path="graphics.html"><a href="graphics.html#rectangles"><i class="fa fa-check"></i><b>3.6</b> Rectangles and polygons</a></li>
<li class="chapter" data-level="3.7" data-path="graphics.html"><a href="graphics.html#axes"><i class="fa fa-check"></i><b>3.7</b> Axes</a></li>
<li class="chapter" data-level="3.8" data-path="graphics.html"><a href="graphics.html#barplots-boxplots-and-violin-plots"><i class="fa fa-check"></i><b>3.8</b> Barplots, boxplots and violin plots</a></li>
<li class="chapter" data-level="3.9" data-path="graphics.html"><a href="graphics.html#circular-arrows"><i class="fa fa-check"></i><b>3.9</b> Circular arrows</a></li>
<li class="chapter" data-level="3.10" data-path="graphics.html"><a href="graphics.html#labels"><i class="fa fa-check"></i><b>3.10</b> Labels</a></li>
<li class="chapter" data-level="3.11" data-path="graphics.html"><a href="graphics.html#raster-image"><i class="fa fa-check"></i><b>3.11</b> Raster image</a></li>
<li class="chapter" data-level="3.12" data-path="graphics.html"><a href="graphics.html#links"><i class="fa fa-check"></i><b>3.12</b> Links</a></li>
<li class="chapter" data-level="3.13" data-path="graphics.html"><a href="graphics.html#highlight-sectors-and-tracks"><i class="fa fa-check"></i><b>3.13</b> Highlight sectors and tracks</a></li>
<li class="chapter" data-level="3.14" data-path="graphics.html"><a href="graphics.html#work-with-base-graphic-system"><i class="fa fa-check"></i><b>3.14</b> Work together with the base graphic system</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>4</b> Legends</a></li>
<li class="chapter" data-level="5" data-path="high-level-plots.html"><a href="high-level-plots.html"><i class="fa fa-check"></i><b>5</b> Implement high-level circular plots</a>
<ul>
<li class="chapter" data-level="5.1" data-path="high-level-plots.html"><a href="high-level-plots.html#circular-barplot"><i class="fa fa-check"></i><b>5.1</b> Circular barplots</a></li>
<li class="chapter" data-level="5.2" data-path="high-level-plots.html"><a href="high-level-plots.html#histograms"><i class="fa fa-check"></i><b>5.2</b> Histograms</a></li>
<li class="chapter" data-level="5.3" data-path="high-level-plots.html"><a href="high-level-plots.html#phylogenetic-trees"><i class="fa fa-check"></i><b>5.3</b> Phylogenetic trees</a></li>
<li class="chapter" data-level="5.4" data-path="high-level-plots.html"><a href="high-level-plots.html#heatmaps"><i class="fa fa-check"></i><b>5.4</b> Manually create heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="circos-heatmap.html"><a href="circos-heatmap.html"><i class="fa fa-check"></i><b>6</b> The <code>circos.heatmap()</code> function</a>
<ul>
<li class="chapter" data-level="6.1" data-path="circos-heatmap.html"><a href="circos-heatmap.html#circos-heatmap-input-data"><i class="fa fa-check"></i><b>6.1</b> Input data</a></li>
<li class="chapter" data-level="6.2" data-path="circos-heatmap.html"><a href="circos-heatmap.html#circular-layout-1"><i class="fa fa-check"></i><b>6.2</b> Circular layout</a></li>
<li class="chapter" data-level="6.3" data-path="circos-heatmap.html"><a href="circos-heatmap.html#dendrograms-and-row-names"><i class="fa fa-check"></i><b>6.3</b> Dendrograms and row names</a></li>
<li class="chapter" data-level="6.4" data-path="circos-heatmap.html"><a href="circos-heatmap.html#clustering"><i class="fa fa-check"></i><b>6.4</b> Clustering</a></li>
<li class="chapter" data-level="6.5" data-path="circos-heatmap.html"><a href="circos-heatmap.html#callback-on-dendrograms"><i class="fa fa-check"></i><b>6.5</b> Callback on dendrograms</a></li>
<li class="chapter" data-level="6.6" data-path="circos-heatmap.html"><a href="circos-heatmap.html#multiple-heatmap-tracks"><i class="fa fa-check"></i><b>6.6</b> Multiple heatmap tracks</a></li>
<li class="chapter" data-level="6.7" data-path="circos-heatmap.html"><a href="circos-heatmap.html#with-other-tracks"><i class="fa fa-check"></i><b>6.7</b> With other tracks</a></li>
<li class="chapter" data-level="6.8" data-path="circos-heatmap.html"><a href="circos-heatmap.html#add-annotations"><i class="fa fa-check"></i><b>6.8</b> Add annotations</a></li>
<li class="chapter" data-level="6.9" data-path="circos-heatmap.html"><a href="circos-heatmap.html#a-complex-example-of-circular-heatmaps"><i class="fa fa-check"></i><b>6.9</b> A complex example of circular heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-layout.html"><a href="advanced-layout.html"><i class="fa fa-check"></i><b>7</b> Advanced layout</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-layout.html"><a href="advanced-layout.html#zooming-of-sectors"><i class="fa fa-check"></i><b>7.1</b> Zooming of sectors</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-layout.html"><a href="advanced-layout.html#part-circle"><i class="fa fa-check"></i><b>7.2</b> Visualize part of the circle</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-layout.html"><a href="advanced-layout.html#combine-circular-plots"><i class="fa fa-check"></i><b>7.3</b> Combine multiple circular plots</a></li>
<li class="chapter" data-level="7.4" data-path="advanced-layout.html"><a href="advanced-layout.html#arrange-multiple-plots"><i class="fa fa-check"></i><b>7.4</b> Arrange multiple plots</a></li>
</ul></li>
<li class="part"><span><b>II Applications in Genomics</b></span></li>
<li class="chapter" data-level="8" data-path="genomic-introduction.html"><a href="genomic-introduction.html"><i class="fa fa-check"></i><b>8</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1" data-path="genomic-introduction.html"><a href="genomic-introduction.html#input-data"><i class="fa fa-check"></i><b>8.1</b> Input data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html"><i class="fa fa-check"></i><b>9</b> Initialize with genomic data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#initialize-cytoband"><i class="fa fa-check"></i><b>9.1</b> Initialize with cytoband data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#basic-usage"><i class="fa fa-check"></i><b>9.1.1</b> Basic usage</a></li>
<li class="chapter" data-level="9.1.2" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#pre-defined-tracks"><i class="fa fa-check"></i><b>9.1.2</b> Pre-defined tracks</a></li>
<li class="chapter" data-level="9.1.3" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#other-general-settings"><i class="fa fa-check"></i><b>9.1.3</b> Other general settings</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#customize-chromosome-track"><i class="fa fa-check"></i><b>9.2</b> Customize chromosome track</a></li>
<li class="chapter" data-level="9.3" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#initialize-with-general-genomic-category"><i class="fa fa-check"></i><b>9.3</b> Initialize with general genomic category</a></li>
<li class="chapter" data-level="9.4" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#zooming-chromosomes"><i class="fa fa-check"></i><b>9.4</b> Zooming chromosomes</a></li>
<li class="chapter" data-level="9.5" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#concatenating-two-genomes"><i class="fa fa-check"></i><b>9.5</b> Concatenating two genomes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html"><i class="fa fa-check"></i><b>10</b> Create plotting regions for genomic data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-points"><i class="fa fa-check"></i><b>10.1</b> Points</a></li>
<li class="chapter" data-level="10.2" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-lines"><i class="fa fa-check"></i><b>10.2</b> Lines</a></li>
<li class="chapter" data-level="10.3" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-text"><i class="fa fa-check"></i><b>10.3</b> Text</a></li>
<li class="chapter" data-level="10.4" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-rectangles"><i class="fa fa-check"></i><b>10.4</b> Rectangles</a></li>
<li class="chapter" data-level="10.5" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-links"><i class="fa fa-check"></i><b>10.5</b> Links</a></li>
<li class="chapter" data-level="10.6" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#mixed-use-of-general-circlize-functions"><i class="fa fa-check"></i><b>10.6</b> Mixed use of general circlize functions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modes-of-input.html"><a href="modes-of-input.html"><i class="fa fa-check"></i><b>11</b> modes for <code>circos.genomicTrack()</code></a>
<ul>
<li class="chapter" data-level="11.1" data-path="modes-of-input.html"><a href="modes-of-input.html#normal-mode"><i class="fa fa-check"></i><b>11.1</b> Normal mode</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-data-frame"><i class="fa fa-check"></i><b>11.1.1</b> Input is a data frame</a></li>
<li class="chapter" data-level="11.1.2" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-list-of-data-frames"><i class="fa fa-check"></i><b>11.1.2</b> Input is a list of data frames</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="modes-of-input.html"><a href="modes-of-input.html#stack-mode"><i class="fa fa-check"></i><b>11.2</b> Stack mode</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-data-frame-1"><i class="fa fa-check"></i><b>11.2.1</b> Input is a data frame</a></li>
<li class="chapter" data-level="11.2.2" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-list-of-data-frames-1"><i class="fa fa-check"></i><b>11.2.2</b> Input is a list of data frames</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="modes-of-input.html"><a href="modes-of-input.html#applications"><i class="fa fa-check"></i><b>11.3</b> Applications</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-points"><i class="fa fa-check"></i><b>11.3.1</b> Points</a></li>
<li class="chapter" data-level="11.3.2" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-lines"><i class="fa fa-check"></i><b>11.3.2</b> Lines</a></li>
<li class="chapter" data-level="11.3.3" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-rectangles"><i class="fa fa-check"></i><b>11.3.3</b> Rectangles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html"><i class="fa fa-check"></i><b>12</b> High-level genomic functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#ideograms"><i class="fa fa-check"></i><b>12.1</b> Ideograms</a></li>
<li class="chapter" data-level="12.2" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-heatmap"><i class="fa fa-check"></i><b>12.2</b> Heatmaps</a></li>
<li class="chapter" data-level="12.3" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#labels-1"><i class="fa fa-check"></i><b>12.3</b> Labels</a></li>
<li class="chapter" data-level="12.4" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-axes"><i class="fa fa-check"></i><b>12.4</b> Genomic axes</a></li>
<li class="chapter" data-level="12.5" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-density-and-rainfall-plot"><i class="fa fa-check"></i><b>12.5</b> Genomic density and Rainfall plot</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nested-zooming.html"><a href="nested-zooming.html"><i class="fa fa-check"></i><b>13</b> Nested zooming</a>
<ul>
<li class="chapter" data-level="13.1" data-path="nested-zooming.html"><a href="nested-zooming.html#basic-idea"><i class="fa fa-check"></i><b>13.1</b> Basic idea</a></li>
<li class="chapter" data-level="13.2" data-path="nested-zooming.html"><a href="nested-zooming.html#visualization-of-dmrs-from-tagmentation-based-wgbs"><i class="fa fa-check"></i><b>13.2</b> Visualization of DMRs from tagmentation-based WGBS</a></li>
</ul></li>
<li class="part"><span><b>III Visualize Relations</b></span></li>
<li class="chapter" data-level="14" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html"><i class="fa fa-check"></i><b>14</b> The <code>chordDiagram()</code> function</a>
<ul>
<li class="chapter" data-level="14.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#basic-usage-of-making-chord-diagram"><i class="fa fa-check"></i><b>14.1</b> Basic usage of making Chord diagram</a></li>
<li class="chapter" data-level="14.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#adjust-by-circos.par"><i class="fa fa-check"></i><b>14.2</b> Adjust by <code>circos.par()</code></a></li>
<li class="chapter" data-level="14.3" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-colors"><i class="fa fa-check"></i><b>14.3</b> Colors</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#set-grid-colors"><i class="fa fa-check"></i><b>14.3.1</b> Set grid colors</a></li>
<li class="chapter" data-level="14.3.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-link-color"><i class="fa fa-check"></i><b>14.3.2</b> Set link colors</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-link-border"><i class="fa fa-check"></i><b>14.4</b> Link border</a></li>
<li class="chapter" data-level="14.5" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#highlight-links"><i class="fa fa-check"></i><b>14.5</b> Highlight links</a></li>
<li class="chapter" data-level="14.6" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#orders-of-links"><i class="fa fa-check"></i><b>14.6</b> Orders of links</a></li>
<li class="chapter" data-level="14.7" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#z-index-of-adding-links"><i class="fa fa-check"></i><b>14.7</b> z-index of adding links</a></li>
<li class="chapter" data-level="14.8" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#self-links"><i class="fa fa-check"></i><b>14.8</b> Self-links</a></li>
<li class="chapter" data-level="14.9" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#symmetric-matrix"><i class="fa fa-check"></i><b>14.9</b> Symmetric matrix</a></li>
<li class="chapter" data-level="14.10" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#directional-relations"><i class="fa fa-check"></i><b>14.10</b> Directional relations</a></li>
<li class="chapter" data-level="14.11" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#scaling"><i class="fa fa-check"></i><b>14.11</b> Scaling</a></li>
<li class="chapter" data-level="14.12" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#reduce"><i class="fa fa-check"></i><b>14.12</b> Reduce</a></li>
<li class="chapter" data-level="14.13" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#input-as-a-data-frame"><i class="fa fa-check"></i><b>14.13</b> Input as a data frame</a>
<ul>
<li class="chapter" data-level="14.13.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#multiple-links-between-two-sectors"><i class="fa fa-check"></i><b>14.13.1</b> Multiple links between two sectors</a></li>
<li class="chapter" data-level="14.13.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#unequal-width-of-the-link-ends"><i class="fa fa-check"></i><b>14.13.2</b> Unequal width of the link ends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html"><i class="fa fa-check"></i><b>15</b> Advanced usage of <code>chordDiagram()</code></a>
<ul>
<li class="chapter" data-level="15.1" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#organization-of-tracks"><i class="fa fa-check"></i><b>15.1</b> Organization of tracks</a></li>
<li class="chapter" data-level="15.2" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#customize-sector-labels"><i class="fa fa-check"></i><b>15.2</b> Customize sector labels</a></li>
<li class="chapter" data-level="15.3" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#customize-sector-axes"><i class="fa fa-check"></i><b>15.3</b> Customize sector axes</a></li>
<li class="chapter" data-level="15.4" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#put-horizontally-or-vertically-symmetric"><i class="fa fa-check"></i><b>15.4</b> Put horizontally or vertically symmetric</a></li>
<li class="chapter" data-level="15.5" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#compare-two-chord-diagrams"><i class="fa fa-check"></i><b>15.5</b> Compare two Chord diagrams</a></li>
<li class="chapter" data-level="15.6" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#multiple-group-chord-diagram"><i class="fa fa-check"></i><b>15.6</b> Multiple-group Chord diagram</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="a-complex-example-of-chord-diagram.html"><a href="a-complex-example-of-chord-diagram.html"><i class="fa fa-check"></i><b>16</b> A complex example of Chord diagram</a></li>
<li class="part"><span><b>IV Others</b></span></li>
<li class="chapter" data-level="17" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html"><i class="fa fa-check"></i><b>17</b> Make fun of the package</a>
<ul>
<li class="chapter" data-level="17.1" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#a-clock"><i class="fa fa-check"></i><b>17.1</b> A clock</a></li>
<li class="chapter" data-level="17.2" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#a-dartboard"><i class="fa fa-check"></i><b>17.2</b> A dartboard</a></li>
<li class="chapter" data-level="17.3" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#ba-gua-and-tai-ji"><i class="fa fa-check"></i><b>17.3</b> Ba-Gua and Tai-Ji</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Circular Visualization in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="make-fun-of-the-package" class="section level1" number="17">
<h1><span class="header-section-number">Chapter 17</span> Make fun of the package</h1>
<div id="a-clock" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> A clock</h2>
<p>The first example is a clock. The key function here is <code>circos.axis()</code> (Figure
<a href="make-fun-of-the-package.html#fig:clock">17.1</a>). In the example, the whole circle only contains one sector in
which major tick at 0 is overlapping with major tick at 12.</p>
<p>Later we calculate the positions of the hour hand, the minute hand and the second hand
based on current time when this Chapter is generated. The hands are drawn by <code>arraws()</code> function
in the canvas coordinate. A real-time clock can be found at the <strong>Examples</strong> section in
the help page of <code>circos.axis()</code>.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="make-fun-of-the-package.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">gap.degree =</span> <span class="dv">0</span>, <span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">start.degree =</span> <span class="dv">90</span>)</span>
<span id="cb437-2"><a href="make-fun-of-the-package.html#cb437-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="st">&quot;a&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>))</span>
<span id="cb437-3"><a href="make-fun-of-the-package.html#cb437-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">bg.border =</span> <span class="cn">NA</span>)</span>
<span id="cb437-4"><a href="make-fun-of-the-package.html#cb437-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.axis</span>(<span class="at">major.at =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">direction =</span> <span class="st">&quot;inside&quot;</span>, </span>
<span id="cb437-5"><a href="make-fun-of-the-package.html#cb437-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">major.tick.length =</span> <span class="fu">mm_y</span>(<span class="dv">2</span>))</span>
<span id="cb437-6"><a href="make-fun-of-the-package.html#cb437-6" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">12</span>) <span class="sc">-</span> <span class="fu">mm_y</span>(<span class="dv">6</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">facing =</span> <span class="st">&quot;downward&quot;</span>)</span>
<span id="cb437-7"><a href="make-fun-of-the-package.html#cb437-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-8"><a href="make-fun-of-the-package.html#cb437-8" aria-hidden="true" tabindex="-1"></a>current.time <span class="ot">=</span> <span class="fu">as.POSIXlt</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb437-9"><a href="make-fun-of-the-package.html#cb437-9" aria-hidden="true" tabindex="-1"></a>sec <span class="ot">=</span> <span class="fu">ceiling</span>(current.time<span class="sc">$</span>sec)</span>
<span id="cb437-10"><a href="make-fun-of-the-package.html#cb437-10" aria-hidden="true" tabindex="-1"></a>min <span class="ot">=</span> current.time<span class="sc">$</span>min</span>
<span id="cb437-11"><a href="make-fun-of-the-package.html#cb437-11" aria-hidden="true" tabindex="-1"></a>hour <span class="ot">=</span> current.time<span class="sc">$</span>hour</span>
<span id="cb437-12"><a href="make-fun-of-the-package.html#cb437-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-13"><a href="make-fun-of-the-package.html#cb437-13" aria-hidden="true" tabindex="-1"></a>sec.degree <span class="ot">=</span> <span class="dv">90</span> <span class="sc">-</span> sec<span class="sc">/</span><span class="dv">60</span> <span class="sc">*</span> <span class="dv">360</span></span>
<span id="cb437-14"><a href="make-fun-of-the-package.html#cb437-14" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">cos</span>(sec.degree<span class="sc">/</span><span class="dv">180</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fl">0.8</span>, <span class="fu">sin</span>(sec.degree<span class="sc">/</span><span class="dv">180</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fl">0.8</span>)</span>
<span id="cb437-15"><a href="make-fun-of-the-package.html#cb437-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-16"><a href="make-fun-of-the-package.html#cb437-16" aria-hidden="true" tabindex="-1"></a>min.degree <span class="ot">=</span> <span class="dv">90</span> <span class="sc">-</span> min<span class="sc">/</span><span class="dv">60</span> <span class="sc">*</span> <span class="dv">360</span></span>
<span id="cb437-17"><a href="make-fun-of-the-package.html#cb437-17" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">cos</span>(min.degree<span class="sc">/</span><span class="dv">180</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fl">0.7</span>, <span class="fu">sin</span>(min.degree<span class="sc">/</span><span class="dv">180</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fl">0.7</span>, <span class="at">lwd =</span> <span class="dv">2</span>)   </span>
<span id="cb437-18"><a href="make-fun-of-the-package.html#cb437-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-19"><a href="make-fun-of-the-package.html#cb437-19" aria-hidden="true" tabindex="-1"></a>hour.degree <span class="ot">=</span> <span class="dv">90</span> <span class="sc">-</span> hour<span class="sc">/</span><span class="dv">12</span> <span class="sc">*</span> <span class="dv">360</span> <span class="sc">-</span> min<span class="sc">/</span><span class="dv">60</span> <span class="sc">*</span> <span class="dv">360</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb437-20"><a href="make-fun-of-the-package.html#cb437-20" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">cos</span>(hour.degree<span class="sc">/</span><span class="dv">180</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fl">0.4</span>, <span class="fu">sin</span>(hour.degree<span class="sc">/</span><span class="dv">180</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fl">0.4</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:clock"></span>
<img src="17-make-fun_files/figure-html/clock-1.png" alt="A clock." width="672" />
<p class="caption">
Figure 17.1: A clock.
</p>
</div>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="make-fun-of-the-package.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
</div>
<div id="a-dartboard" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> A dartboard</h2>
<p>The second example is a dartboard. In Figure <a href="make-fun-of-the-package.html#fig:dartboard">17.2</a>, tracks are assigned with
different heights and each cell is initialized with different colors. The most
inside green ring and red circle are plotted by <code>draw.sector()</code>.</p>
<p>We use <code>circos.trackText()</code> to add labels because we know the global order of the labels.</p>
<p>Now you can project the plot on your door and begin to play!</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="make-fun-of-the-package.html#cb439-1" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>  <span class="co"># just indicate there are 20 sectors</span></span>
<span id="cb439-2"><a href="make-fun-of-the-package.html#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">gap.degree =</span> <span class="dv">0</span>, <span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb439-3"><a href="make-fun-of-the-package.html#cb439-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">start.degree =</span> <span class="dv">360</span><span class="sc">/</span><span class="dv">20</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">track.margin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">clock.wise =</span> <span class="cn">FALSE</span>)</span>
<span id="cb439-4"><a href="make-fun-of-the-package.html#cb439-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb439-5"><a href="make-fun-of-the-package.html#cb439-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-6"><a href="make-fun-of-the-package.html#cb439-6" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">sectors =</span> sectors, <span class="at">bg.col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">track.height =</span> <span class="fl">0.15</span>)</span>
<span id="cb439-7"><a href="make-fun-of-the-package.html#cb439-7" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackText</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">20</span>), <span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">20</span>),</span>
<span id="cb439-8"><a href="make-fun-of-the-package.html#cb439-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">4</span>, <span class="dv">18</span>, <span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">7</span>, <span class="dv">19</span>, <span class="dv">3</span>, <span class="dv">17</span>, <span class="dv">2</span>, <span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">6</span>),</span>
<span id="cb439-9"><a href="make-fun-of-the-package.html#cb439-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">sectors =</span> sectors, <span class="at">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="at">font =</span> <span class="dv">2</span>, <span class="at">facing =</span> <span class="st">&quot;downward&quot;</span>)</span>
<span id="cb439-10"><a href="make-fun-of-the-package.html#cb439-10" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">sectors =</span> sectors,</span>
<span id="cb439-11"><a href="make-fun-of-the-package.html#cb439-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>), <span class="dv">10</span>), <span class="at">bg.border =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="at">track.height =</span> <span class="fl">0.05</span>)</span>
<span id="cb439-12"><a href="make-fun-of-the-package.html#cb439-12" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">sectors =</span> sectors,</span>
<span id="cb439-13"><a href="make-fun-of-the-package.html#cb439-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>), <span class="dv">10</span>), <span class="at">bg.border =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="at">track.height =</span> <span class="fl">0.275</span>)</span>
<span id="cb439-14"><a href="make-fun-of-the-package.html#cb439-14" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">sectors =</span> sectors,</span>
<span id="cb439-15"><a href="make-fun-of-the-package.html#cb439-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>), <span class="dv">10</span>), <span class="at">bg.border =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="at">track.height =</span> <span class="fl">0.05</span>)</span>
<span id="cb439-16"><a href="make-fun-of-the-package.html#cb439-16" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">sectors =</span> sectors, </span>
<span id="cb439-17"><a href="make-fun-of-the-package.html#cb439-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>), <span class="dv">10</span>), <span class="at">bg.border =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="at">track.height =</span> <span class="fl">0.375</span>)</span>
<span id="cb439-18"><a href="make-fun-of-the-package.html#cb439-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-19"><a href="make-fun-of-the-package.html#cb439-19" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.sector</span>(<span class="at">center =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">start.degree =</span> <span class="dv">0</span>, <span class="at">end.degree =</span> <span class="dv">360</span>,</span>
<span id="cb439-20"><a href="make-fun-of-the-package.html#cb439-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">rou1 =</span> <span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">&quot;#4DAF4A&quot;</span>, <span class="at">border =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</span>
<span id="cb439-21"><a href="make-fun-of-the-package.html#cb439-21" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.sector</span>(<span class="at">center =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">start.degree =</span> <span class="dv">0</span>, <span class="at">end.degree =</span> <span class="dv">360</span>,</span>
<span id="cb439-22"><a href="make-fun-of-the-package.html#cb439-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">rou1 =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;#E41A1C&quot;</span>, <span class="at">border =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dartboard"></span>
<img src="17-make-fun_files/figure-html/dartboard-1.png" alt="A dartboard." width="672" />
<p class="caption">
Figure 17.2: A dartboard.
</p>
</div>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="make-fun-of-the-package.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
</div>
<div id="ba-gua-and-tai-ji" class="section level2" number="17.3">
<h2><span class="header-section-number">17.3</span> Ba-Gua and Tai-Ji</h2>
<p>The third example is <a href="https://en.wikipedia.org/wiki/Bagua">Ba-Gua</a>. The
key functions are <code>circos.rect()</code> and <code>draw.sector()</code> (Figure <a href="make-fun-of-the-package.html#fig:bagua">17.3</a>).</p>
<p>Bagua was originated several thousands years ago in China. It is the source of
almost all ancient Chinese philosophy. It abstracts the rule of universe into
base signs and combination of the two basic signs generates the whole system
of the universe.</p>
<p>Inside Ba-Gua, these is the <a href="http://en.wikipedia.org/wiki/Taiji_(philosophy)">Tai-Ji</a>. Tai-Ji refers to the
most original state at the creation of the universe. In ancient Chinese
philosophy system, at the very beginning, the whole world is a huge mass of
air (chaos). Then the lighter air floated up and created sky while heavier
sinked down and created ground. The upper world is called Yang and the bottom
world is called Ying. And that is Tai-Ji.</p>
<p>Looking at Tai-Ji, you can see there are two states interacting with each
other. The white one and the black one gradually transformed into each other
at the end. And in the center of white and black, the opposite color is
generated. In real world, Taiji can represent all phenomenon that is of
dualism. Such as male and female, correct and wrong. However things would
change, good thing would become bad thing as time goes by, and bad thing would
also turn into good according to how you look at the world.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="make-fun-of-the-package.html#cb441-1" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb441-2"><a href="make-fun-of-the-package.html#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">start.degree =</span> <span class="fl">22.5</span>, <span class="at">gap.degree =</span> <span class="dv">6</span>)</span>
<span id="cb441-3"><a href="make-fun-of-the-package.html#cb441-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb441-4"><a href="make-fun-of-the-package.html#cb441-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-5"><a href="make-fun-of-the-package.html#cb441-5" aria-hidden="true" tabindex="-1"></a><span class="co"># yang yao is __ (a long segment)</span></span>
<span id="cb441-6"><a href="make-fun-of-the-package.html#cb441-6" aria-hidden="true" tabindex="-1"></a>add_yang_yao <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb441-7"><a href="make-fun-of-the-package.html#cb441-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.rect</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb441-8"><a href="make-fun-of-the-package.html#cb441-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb441-9"><a href="make-fun-of-the-package.html#cb441-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-10"><a href="make-fun-of-the-package.html#cb441-10" aria-hidden="true" tabindex="-1"></a><span class="co"># yin yao is -- (two short segments)</span></span>
<span id="cb441-11"><a href="make-fun-of-the-package.html#cb441-11" aria-hidden="true" tabindex="-1"></a>add_yin_yao <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb441-12"><a href="make-fun-of-the-package.html#cb441-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.rect</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.45</span>,<span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb441-13"><a href="make-fun-of-the-package.html#cb441-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.rect</span>(<span class="fl">0.55</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb441-14"><a href="make-fun-of-the-package.html#cb441-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb441-15"><a href="make-fun-of-the-package.html#cb441-15" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">sectors =</span> sectors, <span class="at">bg.border =</span> <span class="cn">NA</span>,</span>
<span id="cb441-16"><a href="make-fun-of-the-package.html#cb441-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb441-17"><a href="make-fun-of-the-package.html#cb441-17" aria-hidden="true" tabindex="-1"></a>        i <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.numeric.index&quot;</span>)</span>
<span id="cb441-18"><a href="make-fun-of-the-package.html#cb441-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>)) <span class="fu">add_yang_yao</span>() <span class="cf">else</span> <span class="fu">add_yin_yao</span>()</span>
<span id="cb441-19"><a href="make-fun-of-the-package.html#cb441-19" aria-hidden="true" tabindex="-1"></a>}, <span class="at">track.height =</span> <span class="fl">0.1</span>)</span>
<span id="cb441-20"><a href="make-fun-of-the-package.html#cb441-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-21"><a href="make-fun-of-the-package.html#cb441-21" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">sectors =</span> sectors, <span class="at">bg.border =</span> <span class="cn">NA</span>,</span>
<span id="cb441-22"><a href="make-fun-of-the-package.html#cb441-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb441-23"><a href="make-fun-of-the-package.html#cb441-23" aria-hidden="true" tabindex="-1"></a>        i <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.numeric.index&quot;</span>)</span>
<span id="cb441-24"><a href="make-fun-of-the-package.html#cb441-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)) <span class="fu">add_yang_yao</span>() <span class="cf">else</span> <span class="fu">add_yin_yao</span>()</span>
<span id="cb441-25"><a href="make-fun-of-the-package.html#cb441-25" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">track.height =</span> <span class="fl">0.1</span>)</span>
<span id="cb441-26"><a href="make-fun-of-the-package.html#cb441-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-27"><a href="make-fun-of-the-package.html#cb441-27" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">sectors =</span> sectors, <span class="at">bg.border =</span> <span class="cn">NA</span>, </span>
<span id="cb441-28"><a href="make-fun-of-the-package.html#cb441-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb441-29"><a href="make-fun-of-the-package.html#cb441-29" aria-hidden="true" tabindex="-1"></a>        i <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.numeric.index&quot;</span>)</span>
<span id="cb441-30"><a href="make-fun-of-the-package.html#cb441-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>)) <span class="fu">add_yang_yao</span>() <span class="cf">else</span> <span class="fu">add_yin_yao</span>()</span>
<span id="cb441-31"><a href="make-fun-of-the-package.html#cb441-31" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">track.height =</span> <span class="fl">0.1</span>)</span>
<span id="cb441-32"><a href="make-fun-of-the-package.html#cb441-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-33"><a href="make-fun-of-the-package.html#cb441-33" aria-hidden="true" tabindex="-1"></a><span class="co"># the bottom of the most recent track</span></span>
<span id="cb441-34"><a href="make-fun-of-the-package.html#cb441-34" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;cell.bottom.radius&quot;</span>) <span class="sc">-</span> <span class="fl">0.1</span></span>
<span id="cb441-35"><a href="make-fun-of-the-package.html#cb441-35" aria-hidden="true" tabindex="-1"></a><span class="co"># draw taiji, note default order is clock wise for `draw.sector`</span></span>
<span id="cb441-36"><a href="make-fun-of-the-package.html#cb441-36" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.sector</span>(<span class="at">center =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">start.degree =</span> <span class="dv">90</span>, <span class="at">end.degree =</span> <span class="sc">-</span><span class="dv">90</span>,</span>
<span id="cb441-37"><a href="make-fun-of-the-package.html#cb441-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">rou1 =</span> r, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb441-38"><a href="make-fun-of-the-package.html#cb441-38" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.sector</span>(<span class="at">center =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">start.degree =</span> <span class="dv">270</span>, <span class="at">end.degree =</span> <span class="dv">90</span>,</span>
<span id="cb441-39"><a href="make-fun-of-the-package.html#cb441-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">rou1 =</span> r, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb441-40"><a href="make-fun-of-the-package.html#cb441-40" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.sector</span>(<span class="at">center =</span> <span class="fu">c</span>(<span class="dv">0</span>, r<span class="sc">/</span><span class="dv">2</span>), <span class="at">start.degree =</span> <span class="dv">0</span>, <span class="at">end.degree =</span> <span class="dv">360</span>,</span>
<span id="cb441-41"><a href="make-fun-of-the-package.html#cb441-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">rou1 =</span> r<span class="sc">/</span><span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb441-42"><a href="make-fun-of-the-package.html#cb441-42" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.sector</span>(<span class="at">center =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span>r<span class="sc">/</span><span class="dv">2</span>), <span class="at">start.degree =</span> <span class="dv">0</span>, <span class="at">end.degree =</span> <span class="dv">360</span>,</span>
<span id="cb441-43"><a href="make-fun-of-the-package.html#cb441-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">rou1 =</span> r<span class="sc">/</span><span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb441-44"><a href="make-fun-of-the-package.html#cb441-44" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.sector</span>(<span class="at">center =</span> <span class="fu">c</span>(<span class="dv">0</span>, r<span class="sc">/</span><span class="dv">2</span>), <span class="at">start.degree =</span> <span class="dv">0</span>, <span class="at">end.degree =</span> <span class="dv">360</span>,</span>
<span id="cb441-45"><a href="make-fun-of-the-package.html#cb441-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">rou1 =</span> r<span class="sc">/</span><span class="dv">8</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb441-46"><a href="make-fun-of-the-package.html#cb441-46" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.sector</span>(<span class="at">center =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span>r<span class="sc">/</span><span class="dv">2</span>), <span class="at">start.degree =</span> <span class="dv">0</span>, <span class="at">end.degree =</span> <span class="dv">360</span>,</span>
<span id="cb441-47"><a href="make-fun-of-the-package.html#cb441-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">rou1 =</span> r<span class="sc">/</span><span class="dv">8</span>, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:bagua"></span>
<img src="17-make-fun_files/figure-html/bagua-1.png" alt="Ba-Gua and Tai-Ji." width="672" />
<p class="caption">
Figure 17.3: Ba-Gua and Tai-Ji.
</p>
</div>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="make-fun-of-the-package.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-complex-example-of-chord-diagram.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jokergoo/circlize_book/edit/master/17-make-fun.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
