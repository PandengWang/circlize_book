<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Implement high-level circular plots | Circular Visualization in R</title>
  <meta name="description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Implement high-level circular plots | Circular Visualization in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/jokergoo/circlize-book/book" />
  <meta property="og:image" content="https://bookdown.org/jokergoo/circlize-book/book/images/circlize_cover.jpg" />
  <meta property="og:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="github-repo" content="jokergoo/circlize_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Implement high-level circular plots | Circular Visualization in R" />
  
  <meta name="twitter:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="twitter:image" content="https://bookdown.org/jokergoo/circlize-book/book/images/circlize_cover.jpg" />

<meta name="author" content="Zuguang Gu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="legends.html"/>
<link rel="next" href="circos-heatmap.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Circular Visualization in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="part"><span><b>I General Functionality</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#principle-of-design"><i class="fa fa-check"></i><b>1.1</b> Principle of design</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-qiuck-glance"><i class="fa fa-check"></i><b>1.2</b> A quick glance</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="circular-layout.html"><a href="circular-layout.html"><i class="fa fa-check"></i><b>2</b> Circular layout</a>
<ul>
<li class="chapter" data-level="2.1" data-path="circular-layout.html"><a href="circular-layout.html#coordinate-transformation"><i class="fa fa-check"></i><b>2.1</b> Coordinate transformation</a></li>
<li class="chapter" data-level="2.2" data-path="circular-layout.html"><a href="circular-layout.html#rules-for-making-the-circular-plot"><i class="fa fa-check"></i><b>2.2</b> Rules for making the circular plot</a></li>
<li class="chapter" data-level="2.3" data-path="circular-layout.html"><a href="circular-layout.html#sectors-and-tracks"><i class="fa fa-check"></i><b>2.3</b> Sectors and tracks</a></li>
<li class="chapter" data-level="2.4" data-path="circular-layout.html"><a href="circular-layout.html#graphic-parameters"><i class="fa fa-check"></i><b>2.4</b> Graphic parameters</a></li>
<li class="chapter" data-level="2.5" data-path="circular-layout.html"><a href="circular-layout.html#create-plotting-regions"><i class="fa fa-check"></i><b>2.5</b> Create plotting regions</a></li>
<li class="chapter" data-level="2.6" data-path="circular-layout.html"><a href="circular-layout.html#update-plotting-regions"><i class="fa fa-check"></i><b>2.6</b> Update plotting regions</a></li>
<li class="chapter" data-level="2.7" data-path="circular-layout.html"><a href="circular-layout.html#panel-fun"><i class="fa fa-check"></i><b>2.7</b> <code>panel.fun</code> argument</a></li>
<li class="chapter" data-level="2.8" data-path="circular-layout.html"><a href="circular-layout.html#other-utilities"><i class="fa fa-check"></i><b>2.8</b> Other utilities</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="circular-layout.html"><a href="circular-layout.html#circlize_and_reverse_circlize"><i class="fa fa-check"></i><b>2.8.1</b> <code>circlize()</code> and <code>reverse.circlize()</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="circular-layout.html"><a href="circular-layout.html#convert-functions"><i class="fa fa-check"></i><b>2.8.2</b> Absolute units</a></li>
<li class="chapter" data-level="2.8.3" data-path="circular-layout.html"><a href="circular-layout.html#circos-info-and-circos-clear"><i class="fa fa-check"></i><b>2.8.3</b> <code>circos.info()</code> and <code>circos.clear()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="circular-layout.html"><a href="circular-layout.html#set-gaps-between-tracks"><i class="fa fa-check"></i><b>2.9</b> Set gaps between tracks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>3</b> Graphics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="graphics.html"><a href="graphics.html#setting-colors"><i class="fa fa-check"></i><b>3.1</b> Setting colors</a></li>
<li class="chapter" data-level="3.2" data-path="graphics.html"><a href="graphics.html#points"><i class="fa fa-check"></i><b>3.2</b> Points</a></li>
<li class="chapter" data-level="3.3" data-path="graphics.html"><a href="graphics.html#lines"><i class="fa fa-check"></i><b>3.3</b> Lines</a></li>
<li class="chapter" data-level="3.4" data-path="graphics.html"><a href="graphics.html#segments"><i class="fa fa-check"></i><b>3.4</b> Segments</a></li>
<li class="chapter" data-level="3.5" data-path="graphics.html"><a href="graphics.html#text"><i class="fa fa-check"></i><b>3.5</b> Text</a></li>
<li class="chapter" data-level="3.6" data-path="graphics.html"><a href="graphics.html#rectangles"><i class="fa fa-check"></i><b>3.6</b> Rectangles and polygons</a></li>
<li class="chapter" data-level="3.7" data-path="graphics.html"><a href="graphics.html#axes"><i class="fa fa-check"></i><b>3.7</b> Axes</a></li>
<li class="chapter" data-level="3.8" data-path="graphics.html"><a href="graphics.html#barplots-boxplots-and-violin-plots"><i class="fa fa-check"></i><b>3.8</b> Barplots, boxplots and violin plots</a></li>
<li class="chapter" data-level="3.9" data-path="graphics.html"><a href="graphics.html#circular-arrows"><i class="fa fa-check"></i><b>3.9</b> Circular arrows</a></li>
<li class="chapter" data-level="3.10" data-path="graphics.html"><a href="graphics.html#labels"><i class="fa fa-check"></i><b>3.10</b> Labels</a></li>
<li class="chapter" data-level="3.11" data-path="graphics.html"><a href="graphics.html#raster-image"><i class="fa fa-check"></i><b>3.11</b> Raster image</a></li>
<li class="chapter" data-level="3.12" data-path="graphics.html"><a href="graphics.html#links"><i class="fa fa-check"></i><b>3.12</b> Links</a></li>
<li class="chapter" data-level="3.13" data-path="graphics.html"><a href="graphics.html#highlight-sectors-and-tracks"><i class="fa fa-check"></i><b>3.13</b> Highlight sectors and tracks</a></li>
<li class="chapter" data-level="3.14" data-path="graphics.html"><a href="graphics.html#work-with-base-graphic-system"><i class="fa fa-check"></i><b>3.14</b> Work together with the base graphic system</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>4</b> Legends</a></li>
<li class="chapter" data-level="5" data-path="high-level-plots.html"><a href="high-level-plots.html"><i class="fa fa-check"></i><b>5</b> Implement high-level circular plots</a>
<ul>
<li class="chapter" data-level="5.1" data-path="high-level-plots.html"><a href="high-level-plots.html#circular-barplot"><i class="fa fa-check"></i><b>5.1</b> Circular barplots</a></li>
<li class="chapter" data-level="5.2" data-path="high-level-plots.html"><a href="high-level-plots.html#histograms"><i class="fa fa-check"></i><b>5.2</b> Histograms</a></li>
<li class="chapter" data-level="5.3" data-path="high-level-plots.html"><a href="high-level-plots.html#phylogenetic-trees"><i class="fa fa-check"></i><b>5.3</b> Phylogenetic trees</a></li>
<li class="chapter" data-level="5.4" data-path="high-level-plots.html"><a href="high-level-plots.html#heatmaps"><i class="fa fa-check"></i><b>5.4</b> Manually create heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="circos-heatmap.html"><a href="circos-heatmap.html"><i class="fa fa-check"></i><b>6</b> The <code>circos.heatmap()</code> function</a>
<ul>
<li class="chapter" data-level="6.1" data-path="circos-heatmap.html"><a href="circos-heatmap.html#circos-heatmap-input-data"><i class="fa fa-check"></i><b>6.1</b> Input data</a></li>
<li class="chapter" data-level="6.2" data-path="circos-heatmap.html"><a href="circos-heatmap.html#circular-layout-1"><i class="fa fa-check"></i><b>6.2</b> Circular layout</a></li>
<li class="chapter" data-level="6.3" data-path="circos-heatmap.html"><a href="circos-heatmap.html#dendrograms-and-row-names"><i class="fa fa-check"></i><b>6.3</b> Dendrograms and row names</a></li>
<li class="chapter" data-level="6.4" data-path="circos-heatmap.html"><a href="circos-heatmap.html#clustering"><i class="fa fa-check"></i><b>6.4</b> Clustering</a></li>
<li class="chapter" data-level="6.5" data-path="circos-heatmap.html"><a href="circos-heatmap.html#callback-on-dendrograms"><i class="fa fa-check"></i><b>6.5</b> Callback on dendrograms</a></li>
<li class="chapter" data-level="6.6" data-path="circos-heatmap.html"><a href="circos-heatmap.html#multiple-heatmap-tracks"><i class="fa fa-check"></i><b>6.6</b> Multiple heatmap tracks</a></li>
<li class="chapter" data-level="6.7" data-path="circos-heatmap.html"><a href="circos-heatmap.html#with-other-tracks"><i class="fa fa-check"></i><b>6.7</b> With other tracks</a></li>
<li class="chapter" data-level="6.8" data-path="circos-heatmap.html"><a href="circos-heatmap.html#add-annotations"><i class="fa fa-check"></i><b>6.8</b> Add annotations</a></li>
<li class="chapter" data-level="6.9" data-path="circos-heatmap.html"><a href="circos-heatmap.html#a-complex-example-of-circular-heatmaps"><i class="fa fa-check"></i><b>6.9</b> A complex example of circular heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-layout.html"><a href="advanced-layout.html"><i class="fa fa-check"></i><b>7</b> Advanced layout</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-layout.html"><a href="advanced-layout.html#zooming-of-sectors"><i class="fa fa-check"></i><b>7.1</b> Zooming of sectors</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-layout.html"><a href="advanced-layout.html#part-circle"><i class="fa fa-check"></i><b>7.2</b> Visualize part of the circle</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-layout.html"><a href="advanced-layout.html#combine-circular-plots"><i class="fa fa-check"></i><b>7.3</b> Combine multiple circular plots</a></li>
<li class="chapter" data-level="7.4" data-path="advanced-layout.html"><a href="advanced-layout.html#arrange-multiple-plots"><i class="fa fa-check"></i><b>7.4</b> Arrange multiple plots</a></li>
</ul></li>
<li class="part"><span><b>II Applications in Genomics</b></span></li>
<li class="chapter" data-level="8" data-path="genomic-introduction.html"><a href="genomic-introduction.html"><i class="fa fa-check"></i><b>8</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1" data-path="genomic-introduction.html"><a href="genomic-introduction.html#input-data"><i class="fa fa-check"></i><b>8.1</b> Input data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html"><i class="fa fa-check"></i><b>9</b> Initialize with genomic data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#initialize-cytoband"><i class="fa fa-check"></i><b>9.1</b> Initialize with cytoband data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#basic-usage"><i class="fa fa-check"></i><b>9.1.1</b> Basic usage</a></li>
<li class="chapter" data-level="9.1.2" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#pre-defined-tracks"><i class="fa fa-check"></i><b>9.1.2</b> Pre-defined tracks</a></li>
<li class="chapter" data-level="9.1.3" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#other-general-settings"><i class="fa fa-check"></i><b>9.1.3</b> Other general settings</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#customize-chromosome-track"><i class="fa fa-check"></i><b>9.2</b> Customize chromosome track</a></li>
<li class="chapter" data-level="9.3" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#initialize-with-general-genomic-category"><i class="fa fa-check"></i><b>9.3</b> Initialize with general genomic category</a></li>
<li class="chapter" data-level="9.4" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#zooming-chromosomes"><i class="fa fa-check"></i><b>9.4</b> Zooming chromosomes</a></li>
<li class="chapter" data-level="9.5" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#concatenating-two-genomes"><i class="fa fa-check"></i><b>9.5</b> Concatenating two genomes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html"><i class="fa fa-check"></i><b>10</b> Create plotting regions for genomic data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-points"><i class="fa fa-check"></i><b>10.1</b> Points</a></li>
<li class="chapter" data-level="10.2" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-lines"><i class="fa fa-check"></i><b>10.2</b> Lines</a></li>
<li class="chapter" data-level="10.3" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-text"><i class="fa fa-check"></i><b>10.3</b> Text</a></li>
<li class="chapter" data-level="10.4" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-rectangles"><i class="fa fa-check"></i><b>10.4</b> Rectangles</a></li>
<li class="chapter" data-level="10.5" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-links"><i class="fa fa-check"></i><b>10.5</b> Links</a></li>
<li class="chapter" data-level="10.6" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#mixed-use-of-general-circlize-functions"><i class="fa fa-check"></i><b>10.6</b> Mixed use of general circlize functions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modes-of-input.html"><a href="modes-of-input.html"><i class="fa fa-check"></i><b>11</b> modes for <code>circos.genomicTrack()</code></a>
<ul>
<li class="chapter" data-level="11.1" data-path="modes-of-input.html"><a href="modes-of-input.html#normal-mode"><i class="fa fa-check"></i><b>11.1</b> Normal mode</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-data-frame"><i class="fa fa-check"></i><b>11.1.1</b> Input is a data frame</a></li>
<li class="chapter" data-level="11.1.2" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-list-of-data-frames"><i class="fa fa-check"></i><b>11.1.2</b> Input is a list of data frames</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="modes-of-input.html"><a href="modes-of-input.html#stack-mode"><i class="fa fa-check"></i><b>11.2</b> Stack mode</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-data-frame-1"><i class="fa fa-check"></i><b>11.2.1</b> Input is a data frame</a></li>
<li class="chapter" data-level="11.2.2" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-list-of-data-frames-1"><i class="fa fa-check"></i><b>11.2.2</b> Input is a list of data frames</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="modes-of-input.html"><a href="modes-of-input.html#applications"><i class="fa fa-check"></i><b>11.3</b> Applications</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-points"><i class="fa fa-check"></i><b>11.3.1</b> Points</a></li>
<li class="chapter" data-level="11.3.2" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-lines"><i class="fa fa-check"></i><b>11.3.2</b> Lines</a></li>
<li class="chapter" data-level="11.3.3" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-rectangles"><i class="fa fa-check"></i><b>11.3.3</b> Rectangles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html"><i class="fa fa-check"></i><b>12</b> High-level genomic functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#ideograms"><i class="fa fa-check"></i><b>12.1</b> Ideograms</a></li>
<li class="chapter" data-level="12.2" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-heatmap"><i class="fa fa-check"></i><b>12.2</b> Heatmaps</a></li>
<li class="chapter" data-level="12.3" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#labels-1"><i class="fa fa-check"></i><b>12.3</b> Labels</a></li>
<li class="chapter" data-level="12.4" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-axes"><i class="fa fa-check"></i><b>12.4</b> Genomic axes</a></li>
<li class="chapter" data-level="12.5" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-density-and-rainfall-plot"><i class="fa fa-check"></i><b>12.5</b> Genomic density and Rainfall plot</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nested-zooming.html"><a href="nested-zooming.html"><i class="fa fa-check"></i><b>13</b> Nested zooming</a>
<ul>
<li class="chapter" data-level="13.1" data-path="nested-zooming.html"><a href="nested-zooming.html#basic-idea"><i class="fa fa-check"></i><b>13.1</b> Basic idea</a></li>
<li class="chapter" data-level="13.2" data-path="nested-zooming.html"><a href="nested-zooming.html#visualization-of-dmrs-from-tagmentation-based-wgbs"><i class="fa fa-check"></i><b>13.2</b> Visualization of DMRs from tagmentation-based WGBS</a></li>
</ul></li>
<li class="part"><span><b>III Visualize Relations</b></span></li>
<li class="chapter" data-level="14" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html"><i class="fa fa-check"></i><b>14</b> The <code>chordDiagram()</code> function</a>
<ul>
<li class="chapter" data-level="14.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#basic-usage-of-making-chord-diagram"><i class="fa fa-check"></i><b>14.1</b> Basic usage of making Chord diagram</a></li>
<li class="chapter" data-level="14.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#adjust-by-circos.par"><i class="fa fa-check"></i><b>14.2</b> Adjust by <code>circos.par()</code></a></li>
<li class="chapter" data-level="14.3" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-colors"><i class="fa fa-check"></i><b>14.3</b> Colors</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#set-grid-colors"><i class="fa fa-check"></i><b>14.3.1</b> Set grid colors</a></li>
<li class="chapter" data-level="14.3.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-link-color"><i class="fa fa-check"></i><b>14.3.2</b> Set link colors</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-link-border"><i class="fa fa-check"></i><b>14.4</b> Link border</a></li>
<li class="chapter" data-level="14.5" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#highlight-links"><i class="fa fa-check"></i><b>14.5</b> Highlight links</a></li>
<li class="chapter" data-level="14.6" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#orders-of-links"><i class="fa fa-check"></i><b>14.6</b> Orders of links</a></li>
<li class="chapter" data-level="14.7" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#z-index-of-adding-links"><i class="fa fa-check"></i><b>14.7</b> z-index of adding links</a></li>
<li class="chapter" data-level="14.8" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#self-links"><i class="fa fa-check"></i><b>14.8</b> Self-links</a></li>
<li class="chapter" data-level="14.9" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#symmetric-matrix"><i class="fa fa-check"></i><b>14.9</b> Symmetric matrix</a></li>
<li class="chapter" data-level="14.10" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#directional-relations"><i class="fa fa-check"></i><b>14.10</b> Directional relations</a></li>
<li class="chapter" data-level="14.11" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#scaling"><i class="fa fa-check"></i><b>14.11</b> Scaling</a></li>
<li class="chapter" data-level="14.12" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#reduce"><i class="fa fa-check"></i><b>14.12</b> Reduce</a></li>
<li class="chapter" data-level="14.13" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#input-as-a-data-frame"><i class="fa fa-check"></i><b>14.13</b> Input as a data frame</a>
<ul>
<li class="chapter" data-level="14.13.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#multiple-links-between-two-sectors"><i class="fa fa-check"></i><b>14.13.1</b> Multiple links between two sectors</a></li>
<li class="chapter" data-level="14.13.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#unequal-width-of-the-link-ends"><i class="fa fa-check"></i><b>14.13.2</b> Unequal width of the link ends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html"><i class="fa fa-check"></i><b>15</b> Advanced usage of <code>chordDiagram()</code></a>
<ul>
<li class="chapter" data-level="15.1" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#organization-of-tracks"><i class="fa fa-check"></i><b>15.1</b> Organization of tracks</a></li>
<li class="chapter" data-level="15.2" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#customize-sector-labels"><i class="fa fa-check"></i><b>15.2</b> Customize sector labels</a></li>
<li class="chapter" data-level="15.3" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#customize-sector-axes"><i class="fa fa-check"></i><b>15.3</b> Customize sector axes</a></li>
<li class="chapter" data-level="15.4" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#put-horizontally-or-vertically-symmetric"><i class="fa fa-check"></i><b>15.4</b> Put horizontally or vertically symmetric</a></li>
<li class="chapter" data-level="15.5" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#compare-two-chord-diagrams"><i class="fa fa-check"></i><b>15.5</b> Compare two Chord diagrams</a></li>
<li class="chapter" data-level="15.6" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#multiple-group-chord-diagram"><i class="fa fa-check"></i><b>15.6</b> Multiple-group Chord diagram</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="a-complex-example-of-chord-diagram.html"><a href="a-complex-example-of-chord-diagram.html"><i class="fa fa-check"></i><b>16</b> A complex example of Chord diagram</a></li>
<li class="part"><span><b>IV Others</b></span></li>
<li class="chapter" data-level="17" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html"><i class="fa fa-check"></i><b>17</b> Make fun of the package</a>
<ul>
<li class="chapter" data-level="17.1" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#a-clock"><i class="fa fa-check"></i><b>17.1</b> A clock</a></li>
<li class="chapter" data-level="17.2" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#a-dartboard"><i class="fa fa-check"></i><b>17.2</b> A dartboard</a></li>
<li class="chapter" data-level="17.3" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#ba-gua-and-tai-ji"><i class="fa fa-check"></i><b>17.3</b> Ba-Gua and Tai-Ji</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Circular Visualization in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="high-level-plots" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Implement high-level circular plots</h1>
<p>In this chapter, we show several examples which combine low-level graphic
functions to construct complicated graphics for specific purposes.</p>
<div id="circular-barplot" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Circular barplots</h2>
<p><strong>circlize</strong> already has a <code>circos.barplot()</code> function that draws the
barplots. Here is another type of circular barplots. In the following code, we put all
the nine bars in one track and one sector. You can also put them into 9
tracks, but the code would be very similar. See Figure
<a href="high-level-plots.html#fig:circular-barplot">5.1</a>.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="high-level-plots.html#cb118-1" aria-hidden="true" tabindex="-1"></a>category <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;category&quot;</span>, <span class="st">&quot;_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb118-2"><a href="high-level-plots.html#cb118-2" aria-hidden="true" tabindex="-1"></a>percent <span class="ot">=</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">40</span><span class="sc">:</span><span class="dv">80</span>, <span class="dv">9</span>))</span>
<span id="cb118-3"><a href="high-level-plots.html#cb118-3" aria-hidden="true" tabindex="-1"></a>color <span class="ot">=</span> <span class="fu">rev</span>(<span class="fu">rainbow</span>(<span class="fu">length</span>(percent)))</span>
<span id="cb118-4"><a href="high-level-plots.html#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="high-level-plots.html#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb118-6"><a href="high-level-plots.html#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;start.degree&quot;</span> <span class="ot">=</span> <span class="dv">90</span>, <span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb118-7"><a href="high-level-plots.html#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="st">&quot;a&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="co"># &#39;a` just means there is one sector</span></span>
<span id="cb118-8"><a href="high-level-plots.html#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fu">length</span>(percent)<span class="sc">+</span><span class="fl">0.5</span>), <span class="at">track.height =</span> <span class="fl">0.8</span>, </span>
<span id="cb118-9"><a href="high-level-plots.html#cb118-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.border =</span> <span class="cn">NA</span>, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb118-10"><a href="high-level-plots.html#cb118-10" aria-hidden="true" tabindex="-1"></a>        xlim <span class="ot">=</span> CELL_META<span class="sc">$</span>xlim</span>
<span id="cb118-11"><a href="high-level-plots.html#cb118-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.segments</span>(<span class="fu">rep</span>(xlim[<span class="dv">1</span>], <span class="dv">9</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb118-12"><a href="high-level-plots.html#cb118-12" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">rep</span>(xlim[<span class="dv">2</span>], <span class="dv">9</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb118-13"><a href="high-level-plots.html#cb118-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col =</span> <span class="st">&quot;#CCCCCC&quot;</span>)</span>
<span id="cb118-14"><a href="high-level-plots.html#cb118-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.rect</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">9</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">-</span> <span class="fl">0.45</span>, percent, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">+</span> <span class="fl">0.45</span>,</span>
<span id="cb118-15"><a href="high-level-plots.html#cb118-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> color, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb118-16"><a href="high-level-plots.html#cb118-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(<span class="fu">rep</span>(xlim[<span class="dv">1</span>], <span class="dv">9</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, </span>
<span id="cb118-17"><a href="high-level-plots.html#cb118-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste</span>(category, <span class="st">&quot; - &quot;</span>, percent, <span class="st">&quot;%&quot;</span>), </span>
<span id="cb118-18"><a href="high-level-plots.html#cb118-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">facing =</span> <span class="st">&quot;downward&quot;</span>, <span class="at">adj =</span> <span class="fu">c</span>(<span class="fl">1.05</span>, <span class="fl">0.5</span>), <span class="at">cex =</span> <span class="fl">0.8</span>) </span>
<span id="cb118-19"><a href="high-level-plots.html#cb118-19" aria-hidden="true" tabindex="-1"></a>        breaks <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">85</span>, <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb118-20"><a href="high-level-plots.html#cb118-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">h =</span> <span class="st">&quot;top&quot;</span>, <span class="at">major.at =</span> breaks, <span class="at">labels =</span> <span class="fu">paste0</span>(breaks, <span class="st">&quot;%&quot;</span>), </span>
<span id="cb118-21"><a href="high-level-plots.html#cb118-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb118-22"><a href="high-level-plots.html#cb118-22" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circular-barplot"></span>
<img src="05-implement-high-level-plots_files/figure-html/circular-barplot-1.png" alt="A circular barplot." width="672" />
<p class="caption">
Figure 5.1: A circular barplot.
</p>
</div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="high-level-plots.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
<p>When adding text by <code>circos.text()</code>, <code>adj</code> is specified to <code>c(1.05, 0.5)</code>
which means text is aligned to the right and there is also offset between the
text and the anchor points. We can also use <code>mm_x()</code> to set the offset to
absolute units. Conversion on x direction in a circular coordinate is affected
by the position on y axis, here we must set the <code>h</code> argument. Following code
can be used to replace the <code>circos.text()</code> in above example.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="high-level-plots.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(xlim[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mm_x</span>(<span class="dv">2</span>, <span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, </span>
<span id="cb120-2"><a href="high-level-plots.html#cb120-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(category, <span class="st">&quot; - &quot;</span>, percent, <span class="st">&quot;%&quot;</span>), </span>
<span id="cb120-3"><a href="high-level-plots.html#cb120-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">facing =</span> <span class="st">&quot;downward&quot;</span>, <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>), <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
</div>
<div id="histograms" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Histograms</h2>
<p><strong>circlize</strong> ships a <code>circos.trackHist()</code> function which draws histograms in
cells. This function is a high-level function which caculates data ranges on y
axes and creates a new track. The implement of this function is simple, that it
first calculates the histogram in each cell by <code>hist()</code> function, then draws
histogram by using <code>circos.rect()</code>.</p>
<p>Users can choose to visualize data distributions by density lines by setting
<code>draw.density = TRUE</code>.</p>
<p>Figure <a href="high-level-plots.html#fig:circular-histograms">5.2</a> shows a histogram track under default
settings, a histogram track with specified <code>bin.size</code> and a track with density
lines. By default, bin size of histogram in each cell is calculated
separatedly and they will be different between cells, which makes it not
consistent to compare. Manually setting <code>bin.size</code> in all cells to a same
value helps to compare the distributions between cells.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="high-level-plots.html#cb121-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1600</span>)</span>
<span id="cb121-2"><a href="high-level-plots.html#cb121-2" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>], <span class="dv">1600</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-3"><a href="high-level-plots.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, <span class="at">x =</span> x)</span>
<span id="cb121-4"><a href="high-level-plots.html#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(sectors, <span class="at">x =</span> x, <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>, </span>
<span id="cb121-5"><a href="high-level-plots.html#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">border =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb121-6"><a href="high-level-plots.html#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(sectors, <span class="at">x =</span> x, <span class="at">bin.size =</span> <span class="fl">0.1</span>, </span>
<span id="cb121-7"><a href="high-level-plots.html#cb121-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>, <span class="at">border =</span> <span class="st">&quot;#999999&quot;</span>)</span>
<span id="cb121-8"><a href="high-level-plots.html#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(sectors, <span class="at">x =</span> x, <span class="at">draw.density =</span> <span class="cn">TRUE</span>, </span>
<span id="cb121-9"><a href="high-level-plots.html#cb121-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;#999999&quot;</span>, <span class="at">border =</span> <span class="st">&quot;#999999&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circular-histograms"></span>
<img src="05-implement-high-level-plots_files/figure-html/circular-histograms-1.png" alt="Histograms on circular layout." width="672" />
<p class="caption">
Figure 5.2: Histograms on circular layout.
</p>
</div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="high-level-plots.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
</div>
<div id="phylogenetic-trees" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Phylogenetic trees</h2>
<p>Circular dendrograms have many applications, one of which is to visualize
phylogenetic trees. Basically, a phylogenetic tree is
a dendrogram which is a combination of lines. In R, there are several classes that
describe such type of tree such as <code>hclust</code>, <code>dendrogram</code> and <code>phylo</code>.
In this example, we will demonstrate how to draw the tree from the <code>dendrogram</code> class.
Nevertheless, other classes can be converted to <code>dendrogram</code> without too much difficulty.</p>
<p>The <code>bird.orders</code> data we are using here is from <strong>ape</strong> package. This data set is
related to species of birds.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="high-level-plots.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb123-2"><a href="high-level-plots.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bird.orders)</span>
<span id="cb123-3"><a href="high-level-plots.html#cb123-3" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">=</span> <span class="fu">as.hclust</span>(bird.orders)</span></code></pre></div>
<p>We split the tree into six sub trees by <code>cutree()</code> and convert the data into a
<code>dendrogram</code> object.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="high-level-plots.html#cb124-1" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">=</span> hc<span class="sc">$</span>labels  <span class="co"># name of birds</span></span>
<span id="cb124-2"><a href="high-level-plots.html#cb124-2" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">=</span> <span class="fu">cutree</span>(hc, <span class="dv">6</span>)  <span class="co"># cut tree into 6 pieces</span></span>
<span id="cb124-3"><a href="high-level-plots.html#cb124-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(labels)  <span class="co"># number of bird species</span></span>
<span id="cb124-4"><a href="high-level-plots.html#cb124-4" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">=</span> <span class="fu">as.dendrogram</span>(hc)</span></code></pre></div>
<p>As we mentioned before, the x-value for the phylogenetic tree is in fact
index. Thus, the x-lim is just the minimum and maximum index of labels in the
tree. Since there is only one phylogenetic tree, we only need one “big”
sector.</p>
<p>In the first track, we plot the name of each bird, with different
colors to represent different sub trees.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="high-level-plots.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb125-2"><a href="high-level-plots.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="st">&quot;a&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, n)) <span class="co"># only one sector</span></span>
<span id="cb125-3"><a href="high-level-plots.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">bg.border =</span> <span class="cn">NA</span>, <span class="at">track.height =</span> <span class="fl">0.3</span>, </span>
<span id="cb125-4"><a href="high-level-plots.html#cb125-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb125-5"><a href="high-level-plots.html#cb125-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(n)) {</span>
<span id="cb125-6"><a href="high-level-plots.html#cb125-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">circos.text</span>(i<span class="fl">-0.5</span>, <span class="dv">0</span>, labels[i], <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), </span>
<span id="cb125-7"><a href="high-level-plots.html#cb125-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">facing =</span> <span class="st">&quot;clockwise&quot;</span>, <span class="at">niceFacing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb125-8"><a href="high-level-plots.html#cb125-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> ct[labels[i]], <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb125-9"><a href="high-level-plots.html#cb125-9" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb125-10"><a href="high-level-plots.html#cb125-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>In the above code, setting <code>xlim</code> to <code>c(0, n)</code> is very important because the
leaves of the dendrogram are drawn at <code>x = seq(0.5, n - 0.5)</code>.</p>
<p>In the second track, we plot the circular dendrogram by <code>circos.dendrogram()</code> (Figure <a href="high-level-plots.html#fig:phylogenetic-tree">5.3</a> left).
You can render the dendrogram by <strong>dendextend</strong> package.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="high-level-plots.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(dendextend))</span>
<span id="cb126-2"><a href="high-level-plots.html#cb126-2" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">=</span> <span class="fu">color_branches</span>(dend, <span class="at">k =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb126-3"><a href="high-level-plots.html#cb126-3" aria-hidden="true" tabindex="-1"></a>dend_height <span class="ot">=</span> <span class="fu">attr</span>(dend, <span class="st">&quot;height&quot;</span>)</span>
<span id="cb126-4"><a href="high-level-plots.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, dend_height), <span class="at">bg.border =</span> <span class="cn">NA</span>, </span>
<span id="cb126-5"><a href="high-level-plots.html#cb126-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">track.height =</span> <span class="fl">0.4</span>, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb126-6"><a href="high-level-plots.html#cb126-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.dendrogram</span>(dend)</span>
<span id="cb126-7"><a href="high-level-plots.html#cb126-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb126-8"><a href="high-level-plots.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
<p>By default, dendrograms are facing outside of the circle (so that the labels
should also be added outside the dendrogram). In <code>circos.dendrogram()</code>, you
can set <code>facing</code> argument to <code>inside</code> to make them facing inside. In this
case, dendrogram track is added first and labels are added later (Figure <a href="high-level-plots.html#fig:phylogenetic-tree">5.3</a> right).</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="high-level-plots.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.dendrogram</span>(dend, <span class="at">facing =</span> <span class="st">&quot;inside&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:phylogenetic-tree"></span>
<img src="05-implement-high-level-plots_files/figure-html/phylogenetic-tree-1.png" alt="A circular phylogenetic tree." width="768" />
<p class="caption">
Figure 5.3: A circular phylogenetic tree.
</p>
</div>
<p>If you look at the souce code of <code>circos.dendrogram()</code> and replace
<code>circos.lines()</code> to <code>lines()</code>, actually the function can correctly make a
dendrogram in the normal coordinate.</p>
<p>With the flexibility of <strong>circlize</strong> package, it is easy to add more tracks
if you want to add more corresponded information for the dendrogram to the
plot.</p>
</div>
<div id="heatmaps" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Manually create heatmaps</h2>
<p>Heatmaps, and sometimes combined with dendrograms are frequently used to
visualize e.g. gene expression. Heatmaps are basically composed by rectangles,
thus, they can be implemented by <code>circos.rect()</code>.</p>
<p>In following example, we make a circular plot with two heatmaps. First we
generate the two matrix and perform clustring on the two matrix.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="high-level-plots.html#cb128-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">10</span>), <span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb128-2"><a href="high-level-plots.html#cb128-2" aria-hidden="true" tabindex="-1"></a>col_fun <span class="ot">=</span> <span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb128-3"><a href="high-level-plots.html#cb128-3" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>))</span>
<span id="cb128-4"><a href="high-level-plots.html#cb128-4" aria-hidden="true" tabindex="-1"></a>mat_list <span class="ot">=</span> <span class="fu">list</span>(<span class="at">a =</span> mat[sectors <span class="sc">==</span> <span class="st">&quot;a&quot;</span>, ],</span>
<span id="cb128-5"><a href="high-level-plots.html#cb128-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">b =</span> mat[sectors <span class="sc">==</span> <span class="st">&quot;b&quot;</span>, ])</span>
<span id="cb128-6"><a href="high-level-plots.html#cb128-6" aria-hidden="true" tabindex="-1"></a>dend_list <span class="ot">=</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fu">as.dendrogram</span>(<span class="fu">hclust</span>(<span class="fu">dist</span>(mat_list[[<span class="st">&quot;a&quot;</span>]]))),</span>
<span id="cb128-7"><a href="high-level-plots.html#cb128-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">b =</span> <span class="fu">as.dendrogram</span>(<span class="fu">hclust</span>(<span class="fu">dist</span>(mat_list[[<span class="st">&quot;b&quot;</span>]]))))</span></code></pre></div>
<p>In the first track, columns in the matrix are adjusted by the clustering.
Also note we use <code>circos.rect()</code> in a vectorized way.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="high-level-plots.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">gap.degree =</span> <span class="dv">5</span>)</span>
<span id="cb129-2"><a href="high-level-plots.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, <span class="at">xlim =</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">table</span>(sectors)))</span>
<span id="cb129-3"><a href="high-level-plots.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">bg.border =</span> <span class="cn">NA</span>, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb129-4"><a href="high-level-plots.html#cb129-4" aria-hidden="true" tabindex="-1"></a>    sector.index <span class="ot">=</span> CELL_META<span class="sc">$</span>sector.index</span>
<span id="cb129-5"><a href="high-level-plots.html#cb129-5" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">=</span> mat_list[[sector.index]]</span>
<span id="cb129-6"><a href="high-level-plots.html#cb129-6" aria-hidden="true" tabindex="-1"></a>    dend <span class="ot">=</span> dend_list[[sector.index]]</span>
<span id="cb129-7"><a href="high-level-plots.html#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="high-level-plots.html#cb129-8" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">=</span> m[<span class="fu">order.dendrogram</span>(dend), ]</span>
<span id="cb129-9"><a href="high-level-plots.html#cb129-9" aria-hidden="true" tabindex="-1"></a>    col_mat <span class="ot">=</span> <span class="fu">col_fun</span>(m2)</span>
<span id="cb129-10"><a href="high-level-plots.html#cb129-10" aria-hidden="true" tabindex="-1"></a>    nr <span class="ot">=</span> <span class="fu">nrow</span>(m2)</span>
<span id="cb129-11"><a href="high-level-plots.html#cb129-11" aria-hidden="true" tabindex="-1"></a>    nc <span class="ot">=</span> <span class="fu">ncol</span>(m2)</span>
<span id="cb129-12"><a href="high-level-plots.html#cb129-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nc) {</span>
<span id="cb129-13"><a href="high-level-plots.html#cb129-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.rect</span>(<span class="dv">1</span><span class="sc">:</span>nr <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">rep</span>(nc <span class="sc">-</span> i, nr), </span>
<span id="cb129-14"><a href="high-level-plots.html#cb129-14" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span><span class="sc">:</span>nr, <span class="fu">rep</span>(nc <span class="sc">-</span> i <span class="sc">+</span> <span class="dv">1</span>, nr), </span>
<span id="cb129-15"><a href="high-level-plots.html#cb129-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> col_mat[, i], <span class="at">col =</span> col_mat[, i])</span>
<span id="cb129-16"><a href="high-level-plots.html#cb129-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb129-17"><a href="high-level-plots.html#cb129-17" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Since there are two dendrograms, it is important to make the height
of both dendrogram in a same scale. We calculate the maximum height
of the two dendrograms and set it to <code>ylim</code> of the second track (Figure <a href="high-level-plots.html#fig:circular-heatmap">5.4</a>).</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="high-level-plots.html#cb130-1" aria-hidden="true" tabindex="-1"></a>max_height <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">sapply</span>(dend_list, <span class="cf">function</span>(x) <span class="fu">attr</span>(x, <span class="st">&quot;height&quot;</span>)))</span>
<span id="cb130-2"><a href="high-level-plots.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_height), <span class="at">bg.border =</span> <span class="cn">NA</span>, <span class="at">track.height =</span> <span class="fl">0.3</span>, </span>
<span id="cb130-3"><a href="high-level-plots.html#cb130-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb130-4"><a href="high-level-plots.html#cb130-4" aria-hidden="true" tabindex="-1"></a>        sector.index <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.index&quot;</span>)</span>
<span id="cb130-5"><a href="high-level-plots.html#cb130-5" aria-hidden="true" tabindex="-1"></a>        dend <span class="ot">=</span> dend_list[[sector.index]]</span>
<span id="cb130-6"><a href="high-level-plots.html#cb130-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.dendrogram</span>(dend, <span class="at">max_height =</span> max_height)</span>
<span id="cb130-7"><a href="high-level-plots.html#cb130-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb130-8"><a href="high-level-plots.html#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circular-heatmap"></span>
<img src="05-implement-high-level-plots_files/figure-html/circular-heatmap-1.png" alt="Circular heatmaps." width="672" />
<p class="caption">
Figure 5.4: Circular heatmaps.
</p>
</div>
<p>In the next chapter, we will introduce a high-level function <code>circos.heatmap()</code>
which draws fancy circular heatmaps.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="legends.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="circos-heatmap.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jokergoo/circlize_book/edit/master/05-implement-high-level-plots.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
