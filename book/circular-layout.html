<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Circular layout | Circular Visualization in R</title>
  <meta name="description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Circular layout | Circular Visualization in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/jokergoo/circlize-book/book" />
  <meta property="og:image" content="https://bookdown.org/jokergoo/circlize-book/book/images/circlize_cover.jpg" />
  <meta property="og:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="github-repo" content="jokergoo/circlize_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Circular layout | Circular Visualization in R" />
  
  <meta name="twitter:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="twitter:image" content="https://bookdown.org/jokergoo/circlize-book/book/images/circlize_cover.jpg" />

<meta name="author" content="Zuguang Gu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="graphics.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Circular Visualization in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="part"><span><b>I General Functionality</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#principle-of-design"><i class="fa fa-check"></i><b>1.1</b> Principle of design</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-qiuck-glance"><i class="fa fa-check"></i><b>1.2</b> A quick glance</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="circular-layout.html"><a href="circular-layout.html"><i class="fa fa-check"></i><b>2</b> Circular layout</a>
<ul>
<li class="chapter" data-level="2.1" data-path="circular-layout.html"><a href="circular-layout.html#coordinate-transformation"><i class="fa fa-check"></i><b>2.1</b> Coordinate transformation</a></li>
<li class="chapter" data-level="2.2" data-path="circular-layout.html"><a href="circular-layout.html#rules-for-making-the-circular-plot"><i class="fa fa-check"></i><b>2.2</b> Rules for making the circular plot</a></li>
<li class="chapter" data-level="2.3" data-path="circular-layout.html"><a href="circular-layout.html#sectors-and-tracks"><i class="fa fa-check"></i><b>2.3</b> Sectors and tracks</a></li>
<li class="chapter" data-level="2.4" data-path="circular-layout.html"><a href="circular-layout.html#graphic-parameters"><i class="fa fa-check"></i><b>2.4</b> Graphic parameters</a></li>
<li class="chapter" data-level="2.5" data-path="circular-layout.html"><a href="circular-layout.html#create-plotting-regions"><i class="fa fa-check"></i><b>2.5</b> Create plotting regions</a></li>
<li class="chapter" data-level="2.6" data-path="circular-layout.html"><a href="circular-layout.html#update-plotting-regions"><i class="fa fa-check"></i><b>2.6</b> Update plotting regions</a></li>
<li class="chapter" data-level="2.7" data-path="circular-layout.html"><a href="circular-layout.html#panel-fun"><i class="fa fa-check"></i><b>2.7</b> <code>panel.fun</code> argument</a></li>
<li class="chapter" data-level="2.8" data-path="circular-layout.html"><a href="circular-layout.html#other-utilities"><i class="fa fa-check"></i><b>2.8</b> Other utilities</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="circular-layout.html"><a href="circular-layout.html#circlize_and_reverse_circlize"><i class="fa fa-check"></i><b>2.8.1</b> <code>circlize()</code> and <code>reverse.circlize()</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="circular-layout.html"><a href="circular-layout.html#convert-functions"><i class="fa fa-check"></i><b>2.8.2</b> Absolute units</a></li>
<li class="chapter" data-level="2.8.3" data-path="circular-layout.html"><a href="circular-layout.html#circos-info-and-circos-clear"><i class="fa fa-check"></i><b>2.8.3</b> <code>circos.info()</code> and <code>circos.clear()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="circular-layout.html"><a href="circular-layout.html#set-gaps-between-tracks"><i class="fa fa-check"></i><b>2.9</b> Set gaps between tracks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>3</b> Graphics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="graphics.html"><a href="graphics.html#setting-colors"><i class="fa fa-check"></i><b>3.1</b> Setting colors</a></li>
<li class="chapter" data-level="3.2" data-path="graphics.html"><a href="graphics.html#points"><i class="fa fa-check"></i><b>3.2</b> Points</a></li>
<li class="chapter" data-level="3.3" data-path="graphics.html"><a href="graphics.html#lines"><i class="fa fa-check"></i><b>3.3</b> Lines</a></li>
<li class="chapter" data-level="3.4" data-path="graphics.html"><a href="graphics.html#segments"><i class="fa fa-check"></i><b>3.4</b> Segments</a></li>
<li class="chapter" data-level="3.5" data-path="graphics.html"><a href="graphics.html#text"><i class="fa fa-check"></i><b>3.5</b> Text</a></li>
<li class="chapter" data-level="3.6" data-path="graphics.html"><a href="graphics.html#rectangles"><i class="fa fa-check"></i><b>3.6</b> Rectangles and polygons</a></li>
<li class="chapter" data-level="3.7" data-path="graphics.html"><a href="graphics.html#axes"><i class="fa fa-check"></i><b>3.7</b> Axes</a></li>
<li class="chapter" data-level="3.8" data-path="graphics.html"><a href="graphics.html#barplots-boxplots-and-violin-plots"><i class="fa fa-check"></i><b>3.8</b> Barplots, boxplots and violin plots</a></li>
<li class="chapter" data-level="3.9" data-path="graphics.html"><a href="graphics.html#circular-arrows"><i class="fa fa-check"></i><b>3.9</b> Circular arrows</a></li>
<li class="chapter" data-level="3.10" data-path="graphics.html"><a href="graphics.html#labels"><i class="fa fa-check"></i><b>3.10</b> Labels</a></li>
<li class="chapter" data-level="3.11" data-path="graphics.html"><a href="graphics.html#raster-image"><i class="fa fa-check"></i><b>3.11</b> Raster image</a></li>
<li class="chapter" data-level="3.12" data-path="graphics.html"><a href="graphics.html#links"><i class="fa fa-check"></i><b>3.12</b> Links</a></li>
<li class="chapter" data-level="3.13" data-path="graphics.html"><a href="graphics.html#highlight-sectors-and-tracks"><i class="fa fa-check"></i><b>3.13</b> Highlight sectors and tracks</a></li>
<li class="chapter" data-level="3.14" data-path="graphics.html"><a href="graphics.html#work-with-base-graphic-system"><i class="fa fa-check"></i><b>3.14</b> Work together with the base graphic system</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>4</b> Legends</a></li>
<li class="chapter" data-level="5" data-path="high-level-plots.html"><a href="high-level-plots.html"><i class="fa fa-check"></i><b>5</b> Implement high-level circular plots</a>
<ul>
<li class="chapter" data-level="5.1" data-path="high-level-plots.html"><a href="high-level-plots.html#circular-barplot"><i class="fa fa-check"></i><b>5.1</b> Circular barplots</a></li>
<li class="chapter" data-level="5.2" data-path="high-level-plots.html"><a href="high-level-plots.html#histograms"><i class="fa fa-check"></i><b>5.2</b> Histograms</a></li>
<li class="chapter" data-level="5.3" data-path="high-level-plots.html"><a href="high-level-plots.html#phylogenetic-trees"><i class="fa fa-check"></i><b>5.3</b> Phylogenetic trees</a></li>
<li class="chapter" data-level="5.4" data-path="high-level-plots.html"><a href="high-level-plots.html#heatmaps"><i class="fa fa-check"></i><b>5.4</b> Manually create heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="circos-heatmap.html"><a href="circos-heatmap.html"><i class="fa fa-check"></i><b>6</b> The <code>circos.heatmap()</code> function</a>
<ul>
<li class="chapter" data-level="6.1" data-path="circos-heatmap.html"><a href="circos-heatmap.html#circos-heatmap-input-data"><i class="fa fa-check"></i><b>6.1</b> Input data</a></li>
<li class="chapter" data-level="6.2" data-path="circos-heatmap.html"><a href="circos-heatmap.html#circular-layout-1"><i class="fa fa-check"></i><b>6.2</b> Circular layout</a></li>
<li class="chapter" data-level="6.3" data-path="circos-heatmap.html"><a href="circos-heatmap.html#dendrograms-and-row-names"><i class="fa fa-check"></i><b>6.3</b> Dendrograms and row names</a></li>
<li class="chapter" data-level="6.4" data-path="circos-heatmap.html"><a href="circos-heatmap.html#clustering"><i class="fa fa-check"></i><b>6.4</b> Clustering</a></li>
<li class="chapter" data-level="6.5" data-path="circos-heatmap.html"><a href="circos-heatmap.html#callback-on-dendrograms"><i class="fa fa-check"></i><b>6.5</b> Callback on dendrograms</a></li>
<li class="chapter" data-level="6.6" data-path="circos-heatmap.html"><a href="circos-heatmap.html#multiple-heatmap-tracks"><i class="fa fa-check"></i><b>6.6</b> Multiple heatmap tracks</a></li>
<li class="chapter" data-level="6.7" data-path="circos-heatmap.html"><a href="circos-heatmap.html#with-other-tracks"><i class="fa fa-check"></i><b>6.7</b> With other tracks</a></li>
<li class="chapter" data-level="6.8" data-path="circos-heatmap.html"><a href="circos-heatmap.html#add-annotations"><i class="fa fa-check"></i><b>6.8</b> Add annotations</a></li>
<li class="chapter" data-level="6.9" data-path="circos-heatmap.html"><a href="circos-heatmap.html#a-complex-example-of-circular-heatmaps"><i class="fa fa-check"></i><b>6.9</b> A complex example of circular heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-layout.html"><a href="advanced-layout.html"><i class="fa fa-check"></i><b>7</b> Advanced layout</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-layout.html"><a href="advanced-layout.html#zooming-of-sectors"><i class="fa fa-check"></i><b>7.1</b> Zooming of sectors</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-layout.html"><a href="advanced-layout.html#part-circle"><i class="fa fa-check"></i><b>7.2</b> Visualize part of the circle</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-layout.html"><a href="advanced-layout.html#combine-circular-plots"><i class="fa fa-check"></i><b>7.3</b> Combine multiple circular plots</a></li>
<li class="chapter" data-level="7.4" data-path="advanced-layout.html"><a href="advanced-layout.html#arrange-multiple-plots"><i class="fa fa-check"></i><b>7.4</b> Arrange multiple plots</a></li>
</ul></li>
<li class="part"><span><b>II Applications in Genomics</b></span></li>
<li class="chapter" data-level="8" data-path="genomic-introduction.html"><a href="genomic-introduction.html"><i class="fa fa-check"></i><b>8</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1" data-path="genomic-introduction.html"><a href="genomic-introduction.html#input-data"><i class="fa fa-check"></i><b>8.1</b> Input data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html"><i class="fa fa-check"></i><b>9</b> Initialize with genomic data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#initialize-cytoband"><i class="fa fa-check"></i><b>9.1</b> Initialize with cytoband data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#basic-usage"><i class="fa fa-check"></i><b>9.1.1</b> Basic usage</a></li>
<li class="chapter" data-level="9.1.2" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#pre-defined-tracks"><i class="fa fa-check"></i><b>9.1.2</b> Pre-defined tracks</a></li>
<li class="chapter" data-level="9.1.3" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#other-general-settings"><i class="fa fa-check"></i><b>9.1.3</b> Other general settings</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#customize-chromosome-track"><i class="fa fa-check"></i><b>9.2</b> Customize chromosome track</a></li>
<li class="chapter" data-level="9.3" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#initialize-with-general-genomic-category"><i class="fa fa-check"></i><b>9.3</b> Initialize with general genomic category</a></li>
<li class="chapter" data-level="9.4" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#zooming-chromosomes"><i class="fa fa-check"></i><b>9.4</b> Zooming chromosomes</a></li>
<li class="chapter" data-level="9.5" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#concatenating-two-genomes"><i class="fa fa-check"></i><b>9.5</b> Concatenating two genomes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html"><i class="fa fa-check"></i><b>10</b> Create plotting regions for genomic data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-points"><i class="fa fa-check"></i><b>10.1</b> Points</a></li>
<li class="chapter" data-level="10.2" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-lines"><i class="fa fa-check"></i><b>10.2</b> Lines</a></li>
<li class="chapter" data-level="10.3" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-text"><i class="fa fa-check"></i><b>10.3</b> Text</a></li>
<li class="chapter" data-level="10.4" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-rectangles"><i class="fa fa-check"></i><b>10.4</b> Rectangles</a></li>
<li class="chapter" data-level="10.5" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-links"><i class="fa fa-check"></i><b>10.5</b> Links</a></li>
<li class="chapter" data-level="10.6" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#mixed-use-of-general-circlize-functions"><i class="fa fa-check"></i><b>10.6</b> Mixed use of general circlize functions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modes-of-input.html"><a href="modes-of-input.html"><i class="fa fa-check"></i><b>11</b> modes for <code>circos.genomicTrack()</code></a>
<ul>
<li class="chapter" data-level="11.1" data-path="modes-of-input.html"><a href="modes-of-input.html#normal-mode"><i class="fa fa-check"></i><b>11.1</b> Normal mode</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-data-frame"><i class="fa fa-check"></i><b>11.1.1</b> Input is a data frame</a></li>
<li class="chapter" data-level="11.1.2" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-list-of-data-frames"><i class="fa fa-check"></i><b>11.1.2</b> Input is a list of data frames</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="modes-of-input.html"><a href="modes-of-input.html#stack-mode"><i class="fa fa-check"></i><b>11.2</b> Stack mode</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-data-frame-1"><i class="fa fa-check"></i><b>11.2.1</b> Input is a data frame</a></li>
<li class="chapter" data-level="11.2.2" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-list-of-data-frames-1"><i class="fa fa-check"></i><b>11.2.2</b> Input is a list of data frames</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="modes-of-input.html"><a href="modes-of-input.html#applications"><i class="fa fa-check"></i><b>11.3</b> Applications</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-points"><i class="fa fa-check"></i><b>11.3.1</b> Points</a></li>
<li class="chapter" data-level="11.3.2" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-lines"><i class="fa fa-check"></i><b>11.3.2</b> Lines</a></li>
<li class="chapter" data-level="11.3.3" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-rectangles"><i class="fa fa-check"></i><b>11.3.3</b> Rectangles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html"><i class="fa fa-check"></i><b>12</b> High-level genomic functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#ideograms"><i class="fa fa-check"></i><b>12.1</b> Ideograms</a></li>
<li class="chapter" data-level="12.2" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-heatmap"><i class="fa fa-check"></i><b>12.2</b> Heatmaps</a></li>
<li class="chapter" data-level="12.3" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#labels-1"><i class="fa fa-check"></i><b>12.3</b> Labels</a></li>
<li class="chapter" data-level="12.4" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-axes"><i class="fa fa-check"></i><b>12.4</b> Genomic axes</a></li>
<li class="chapter" data-level="12.5" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-density-and-rainfall-plot"><i class="fa fa-check"></i><b>12.5</b> Genomic density and Rainfall plot</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nested-zooming.html"><a href="nested-zooming.html"><i class="fa fa-check"></i><b>13</b> Nested zooming</a>
<ul>
<li class="chapter" data-level="13.1" data-path="nested-zooming.html"><a href="nested-zooming.html#basic-idea"><i class="fa fa-check"></i><b>13.1</b> Basic idea</a></li>
<li class="chapter" data-level="13.2" data-path="nested-zooming.html"><a href="nested-zooming.html#visualization-of-dmrs-from-tagmentation-based-wgbs"><i class="fa fa-check"></i><b>13.2</b> Visualization of DMRs from tagmentation-based WGBS</a></li>
</ul></li>
<li class="part"><span><b>III Visualize Relations</b></span></li>
<li class="chapter" data-level="14" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html"><i class="fa fa-check"></i><b>14</b> The <code>chordDiagram()</code> function</a>
<ul>
<li class="chapter" data-level="14.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#basic-usage-of-making-chord-diagram"><i class="fa fa-check"></i><b>14.1</b> Basic usage of making Chord diagram</a></li>
<li class="chapter" data-level="14.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#adjust-by-circos.par"><i class="fa fa-check"></i><b>14.2</b> Adjust by <code>circos.par()</code></a></li>
<li class="chapter" data-level="14.3" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-colors"><i class="fa fa-check"></i><b>14.3</b> Colors</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#set-grid-colors"><i class="fa fa-check"></i><b>14.3.1</b> Set grid colors</a></li>
<li class="chapter" data-level="14.3.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-link-color"><i class="fa fa-check"></i><b>14.3.2</b> Set link colors</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-link-border"><i class="fa fa-check"></i><b>14.4</b> Link border</a></li>
<li class="chapter" data-level="14.5" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#highlight-links"><i class="fa fa-check"></i><b>14.5</b> Highlight links</a></li>
<li class="chapter" data-level="14.6" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#orders-of-links"><i class="fa fa-check"></i><b>14.6</b> Orders of links</a></li>
<li class="chapter" data-level="14.7" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#z-index-of-adding-links"><i class="fa fa-check"></i><b>14.7</b> z-index of adding links</a></li>
<li class="chapter" data-level="14.8" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#self-links"><i class="fa fa-check"></i><b>14.8</b> Self-links</a></li>
<li class="chapter" data-level="14.9" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#symmetric-matrix"><i class="fa fa-check"></i><b>14.9</b> Symmetric matrix</a></li>
<li class="chapter" data-level="14.10" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#directional-relations"><i class="fa fa-check"></i><b>14.10</b> Directional relations</a></li>
<li class="chapter" data-level="14.11" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#scaling"><i class="fa fa-check"></i><b>14.11</b> Scaling</a></li>
<li class="chapter" data-level="14.12" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#reduce"><i class="fa fa-check"></i><b>14.12</b> Reduce</a></li>
<li class="chapter" data-level="14.13" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#input-as-a-data-frame"><i class="fa fa-check"></i><b>14.13</b> Input as a data frame</a>
<ul>
<li class="chapter" data-level="14.13.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#multiple-links-between-two-sectors"><i class="fa fa-check"></i><b>14.13.1</b> Multiple links between two sectors</a></li>
<li class="chapter" data-level="14.13.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#unequal-width-of-the-link-ends"><i class="fa fa-check"></i><b>14.13.2</b> Unequal width of the link ends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html"><i class="fa fa-check"></i><b>15</b> Advanced usage of <code>chordDiagram()</code></a>
<ul>
<li class="chapter" data-level="15.1" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#organization-of-tracks"><i class="fa fa-check"></i><b>15.1</b> Organization of tracks</a></li>
<li class="chapter" data-level="15.2" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#customize-sector-labels"><i class="fa fa-check"></i><b>15.2</b> Customize sector labels</a></li>
<li class="chapter" data-level="15.3" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#customize-sector-axes"><i class="fa fa-check"></i><b>15.3</b> Customize sector axes</a></li>
<li class="chapter" data-level="15.4" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#put-horizontally-or-vertically-symmetric"><i class="fa fa-check"></i><b>15.4</b> Put horizontally or vertically symmetric</a></li>
<li class="chapter" data-level="15.5" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#compare-two-chord-diagrams"><i class="fa fa-check"></i><b>15.5</b> Compare two Chord diagrams</a></li>
<li class="chapter" data-level="15.6" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#multiple-group-chord-diagram"><i class="fa fa-check"></i><b>15.6</b> Multiple-group Chord diagram</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="a-complex-example-of-chord-diagram.html"><a href="a-complex-example-of-chord-diagram.html"><i class="fa fa-check"></i><b>16</b> A complex example of Chord diagram</a></li>
<li class="part"><span><b>IV Others</b></span></li>
<li class="chapter" data-level="17" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html"><i class="fa fa-check"></i><b>17</b> Make fun of the package</a>
<ul>
<li class="chapter" data-level="17.1" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#a-clock"><i class="fa fa-check"></i><b>17.1</b> A clock</a></li>
<li class="chapter" data-level="17.2" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#a-dartboard"><i class="fa fa-check"></i><b>17.2</b> A dartboard</a></li>
<li class="chapter" data-level="17.3" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#ba-gua-and-tai-ji"><i class="fa fa-check"></i><b>17.3</b> Ba-Gua and Tai-Ji</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Circular Visualization in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="circular-layout" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Circular layout</h1>
<div id="coordinate-transformation" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Coordinate transformation</h2>
<p>To map graphics onto the circle, there exist transformations among several
coordinate systems. First, there are <strong>data coordinate systems</strong> in which
ranges for x-axes and y-axes are the ranges of original data. Second, there is
a <strong>polar coordinate system</strong> in which these coordinates are mapped onto a
circle. Finally, there is a <strong>canvas coordinate system</strong> in which graphics are
really drawn on the graphic device (Figure <a href="circular-layout.html#fig:coordinate-transformation">2.1</a>).
Each cell has its own data coordinate and they are
independent. <strong>circlize</strong> first transforms coordinates from data coordinate
system to polar coordinate system and finally transforms into canvas
coordinate system. For users, they only need to imagine that each cell is a
normal rectangular plotting region (data coordinate) in which x-lim and y-lim
are ranges of data in that cell. <strong>circlize</strong> knows which cell you are in and
does all the transformations automatically.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:coordinate-transformation"></span>
<img src="02-circlize-layout_files/figure-html/coordinate-transformation-1.png" alt="Transformation between different coordinates" width="768" />
<p class="caption">
Figure 2.1: Transformation between different coordinates
</p>
</div>
<p>The final canvas coordinate is in fact an ordinary coordinate in the base R
graphic system with x-range in <code>(-1, 1)</code> and y-range in <code>(-1, 1)</code> by default.
It should be noted that <strong>the circular plot is always drawn inside the circle which has
radius of 1 (which means it is always a unit circle), and from outside to
inside</strong>.</p>
</div>
<div id="rules-for-making-the-circular-plot" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Rules for making the circular plot</h2>
<p>The rule for making the circular plot is rather simple. It follows the sequence of
<code>initialize layout -&gt; create track -&gt; add graphics -&gt; create track -&gt; add graphics - ... -&gt; clear</code>.
Graphics can be added at any time as long as the tracks are created.
Details are shown in Figure <a href="circular-layout.html#fig:circlize-order">2.2</a> and as follows:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circlize-order"></span>
<img src="02-circlize-layout_files/figure-html/circlize-order-1.png" alt="Order of drawing circular layout." width="768" />
<p class="caption">
Figure 2.2: Order of drawing circular layout.
</p>
</div>
<ol style="list-style-type: decimal">
<li><p>Initialize the layout using <code>circos.initialize()</code>. Since circular layout in
fact visualizes data which is in categories, there must be at least a
categorical variable. Ranges of x values on each category can be specified
as a vector or the range itself. See Section <a href="circular-layout.html#sectors-and-tracks">2.3</a>.</p></li>
<li><p>Create plotting regions for the new track and add graphics. The new track
is created just inside the previously created one. Only after the creation
of the track can you add other graphics on it. There are three ways to add
graphics in cells.</p>
<ul>
<li>After the creation of the track, use low-level graphic function like
<code>circos.points()</code>, <code>circos.lines()</code>, … to add graphics cell by
cell. It always involves a <code>for</code> loop and you need to subset the data
by the categorical variable manually.</li>
<li>Use <code>circos.trackPoints()</code>, <code>circos.trackLines()</code>, … to add
simple graphics through all cells simultaneously.</li>
<li>Use <code>panel.fun</code> argument in <code>circos.track()</code> to add graphics
immediately after the creation of a certain cell. <code>panel.fun</code> needs
two arguments <code>x</code> and <code>y</code> which are x values and y values that are in
the current cell. This subset operation is applied automatically.
This is the most recommended way. Section <a href="circular-layout.html#panel-fun">2.7</a> gives
detailed explanation of using <code>panel.fun</code> argument.</li>
</ul></li>
<li><p>Repeat step 2 to add more tracks on the circle unless it reaches the center
of the circle.</p></li>
<li><p>Call <code>circos.clear()</code> to clean up.</p></li>
</ol>
<p>As mentioned above, there are three ways to add graphics on a track.</p>
<ol style="list-style-type: decimal">
<li><p>Create plotting regions for the whole track first and then add graphics
by specifying <code>sector.index</code>. In the following pseudo code, <code>x1</code>, <code>y1</code>
are data points in a given cell, which means you need to do data
subsetting manually.</p>
<p>In following code, <code>circos.points()</code> and <code>circos.lines()</code> are used
separatedly from <code>circos.track()</code>, thus, the index for the sector needs
to be explicitly specified by <code>sector.index</code> argument. There is also a
<code>track.index</code> argument for both functions, however, the default value is
the “current” track index and as the two functions are used just after
<code>circos.track()</code>, the “current” track index is what the two functions
expect and it can be ommited when calling the two functions.</p></li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="circular-layout.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, xlim)</span>
<span id="cb12-2"><a href="circular-layout.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(ylim)</span>
<span id="cb12-3"><a href="circular-layout.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(sector.index <span class="cf">in</span> all.sector.index) {</span>
<span id="cb12-4"><a href="circular-layout.html#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.points</span>(x1, y1, sector.index)</span>
<span id="cb12-5"><a href="circular-layout.html#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.lines</span>(x2, y2, sector.index)</span>
<span id="cb12-6"><a href="circular-layout.html#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Add graphics in a batch mode. In following code, <code>circos.trackPoints()</code>
and <code>circos.trackLines()</code> need a categorical variable, a vector of x
values and a vector of y values. X and y values will be split by the
categorical variable and sent to corresponding cell to add the graphics.
Internally, this is done by using <code>circos.points()</code> or <code>circos.lines()</code>
in a <code>for</code> loop. This way to add graphics would be convenient if users
only want to add a specific type of simple graphics (e.g. only points) to
the track, but it is not recommended for making complex graphics.</p>
<p><code>circos.trackPoints()</code> and <code>circos.trackLines()</code> need a <code>track.index</code> to
specify which track to add the graphics. Similarly, since these two are
called just after <code>circos.track()</code>, the graphics are added in the newly
created track right away.</p></li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="circular-layout.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, xlim)</span>
<span id="cb13-2"><a href="circular-layout.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(ylim)</span>
<span id="cb13-3"><a href="circular-layout.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(sectors, x, y)</span>
<span id="cb13-4"><a href="circular-layout.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackLines</span>(sectors, x, y)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><p>Use a panel function to add self-defined graphics as soon as the cell has
been created. This is the way recommended and you can find most of the
code in this book uses <code>panel.fun</code>. <code>circos.track()</code> creates cells one by
one and after the creation of a cell, and <code>panel.fun</code> is executed on this
cell immediately. In this case, the “current” sector and “current” track
are marked to this cell that you can directly use low-level functions
without specifying sector index and track index.</p>
<p>If you look at following code, you will find the code inside <code>panel.fun</code>
is as natural as using <code>points()</code> or <code>lines()</code> in the normal R graphic
system. This is a way to help you think a cell is an “imaginary
rectangular plotting region.”</p></li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="circular-layout.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, xlim)</span>
<span id="cb14-2"><a href="circular-layout.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(sectors, all_x, all_y, ylim,</span>
<span id="cb14-3"><a href="circular-layout.html#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb14-4"><a href="circular-layout.html#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.points</span>(x, y)</span>
<span id="cb14-5"><a href="circular-layout.html#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(x, y)</span>
<span id="cb14-6"><a href="circular-layout.html#cb14-6" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>There are several internal variables keeping tracing of the current sector and
track when applying <code>circos.track()</code> and <code>circos.update()</code>. Thus, although
functions like <code>circos.points()</code>, <code>circos.lines()</code> need to specify the index
of sector and track, they will take the current one by default. As a result,
if you draw points, lines, text <em>et al</em> just after the creation of the track
or cell, you do not need to set the sector index and the track index
explicitly and it will be added in the most recently created or updated cell.</p>
</div>
<div id="sectors-and-tracks" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Sectors and tracks</h2>
<p>A circular layout is composed of sectors and tracks. As illustrated in Figure
<a href="circular-layout.html#fig:circlize-coordinate">2.3</a>, the red circle is one track and the blue represents
one sector. The intersection of a sector and a track is called a cell which
can be thought as an imaginary plotting region for data points. In this
section, we introduce how to set data ranges on x and y directions in cells.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circlize-coordinate"></span>
<img src="02-circlize-layout_files/figure-html/circlize-coordinate-1.png" alt="Sectors and tracks in circular layout." width="384" />
<p class="caption">
Figure 2.3: Sectors and tracks in circular layout.
</p>
</div>
<p>Sectors are first allocated on the circle by <code>circos.initialize()</code>. There must
be a categorical variable (say <code>sectors</code>) that on the circle, each sector
corresponds to one category. The width of sectors (measured by degree) are proportional to the data
range in sectors on x direction (or the circular direction). The data range can be specified as a numeric
vector <code>x</code> which has same length as <code>sectors</code>, then <code>x</code> is split by <code>sectors</code>
and data ranges are calculated for each sector internally.</p>
<p>Data ranges can also be specified directly by <code>xlim</code> argument. The valid value
for <code>xilm</code> is a two-column matrix with same number of rows as number of
sectors that each row in <code>xlim</code> corresponds to one sector. If <code>xlim</code> has row
names which already cover sector names, row order of <code>xlim</code> is automatically
adjusted. If <code>xlim</code> is a vector of length two, all sectors have the same x range.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="circular-layout.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, <span class="at">x =</span> x)</span>
<span id="cb15-2"><a href="circular-layout.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, <span class="at">xlim =</span> xlim)</span></code></pre></div>
<p>If <code>sectors</code> is not specified, the row names of <code>xlim</code> are taken as the value for <code>sectors</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="circular-layout.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">xlim =</span> xlim)</span></code></pre></div>
<p>After the initialization of the layout, you may not see anything drawn or only an
empty graphical device is opened. That is because no track has been created
yet, however, the layout has already been recorded internally.</p>
<p>In the initialization step, not only the width of each sector is assigned, but
also the order of sectors on the circle is determined. <strong>Order of the sectors
are determined by the order of levels of the input factor</strong>. If the value for
<code>sectors</code> is not a factor, the order of sectors is <code>unique(sectors)</code>. Thus, if
you want to change the order of sectors, you can just change of the level of
<code>sectors</code> variable. The following code generates plots with different
sector orders (Figure <a href="circular-layout.html#fig:circlize-factor">2.4</a>).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="circular-layout.html#cb17-1" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;d&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb17-2"><a href="circular-layout.html#cb17-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">=</span> <span class="fu">factor</span>(sectors)</span>
<span id="cb17-3"><a href="circular-layout.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(s1, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb17-4"><a href="circular-layout.html#cb17-4" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">=</span> <span class="fu">factor</span>(sectors, <span class="at">levels =</span> sectors)</span>
<span id="cb17-5"><a href="circular-layout.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(s2, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circlize-factor"></span>
<img src="02-circlize-layout_files/figure-html/circlize-factor-1.png" alt="Different sector orders." width="768" />
<p class="caption">
Figure 2.4: Different sector orders.
</p>
</div>
<p><strong>In different tracks, cells in the same sector share the same data range on
x-axes.</strong> Then, for each track, we only need to specify the data range on y
direction (or the radical direction) for cells. Similar as <code>circos.initialize()</code>, <code>circos.track()</code> also
receives either <code>y</code> or <code>ylim</code> argument to specify the range of y-values. Since
all cells in a same track share a same y range, <code>ylim</code> is just a vector of
length two if it is specified.</p>
<p><code>x</code> can also be specified in <code>circos.track()</code>, but it is only used to send to
<code>panel.fun</code>. In Section <a href="circular-layout.html#panel-fun">2.7</a>, we will introduce how <code>x</code> and <code>y</code>
are sent to each cell and how the graphics are added.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="circular-layout.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(sectors, <span class="at">y =</span> y)</span>
<span id="cb18-2"><a href="circular-layout.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(sectors, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb18-3"><a href="circular-layout.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(sectors, <span class="at">x =</span> x, <span class="at">y =</span> y)</span></code></pre></div>
<p>In the track creation step, since all sectors have already been allocated in
the circle, if <code>sectors</code> argument is not set, <code>circos.track()</code> would create
plotting regions for all available sectors. Also, levels of <code>sectors</code> do
not need to be specified explicitly because the order of sectors has already
be determined in the initialization step. If users only create cells for a subset
of sectors in the track (not all sectors), in fact, cells in remaining
unspecified sectors are created as well, but with no borders (pretending they
are not created).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="circular-layout.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assume `sectors` only covers a subset of sectors</span></span>
<span id="cb19-2"><a href="circular-layout.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># You will only see cells that are covered in `sectors` have borders</span></span>
<span id="cb19-3"><a href="circular-layout.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(sectors, <span class="at">y =</span> y)</span>
<span id="cb19-4"><a href="circular-layout.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># You will see all cells have borders</span></span>
<span id="cb19-5"><a href="circular-layout.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb19-6"><a href="circular-layout.html#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">ranges</span>(y))</span></code></pre></div>
<p>Cells are basic units in the circular plot and are independent from each
other. After the creation of cells, they have self-contained meta values of
x-lim and y-lim (data range measured in data coordinate). So if you are adding
graphics in one cell, you do not need to consider things outside the cell and
also you do not need to consider you are in the circle. Just pretending it is
normal rectangle region with its own coordinate.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circlize-direction"></span>
<img src="02-circlize-layout_files/figure-html/circlize-direction-1.png" alt="Sector directions." width="768" />
<p class="caption">
Figure 2.5: Sector directions.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circlize-axis-direction"></span>
<img src="02-circlize-layout_files/figure-html/circlize-axis-direction-1.png" alt="Axes directions." width="768" />
<p class="caption">
Figure 2.6: Axes directions.
</p>
</div>
</div>
<div id="graphic-parameters" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Graphic parameters</h2>
<p>Some basic parameters for the circular layout can be set by <code>circos.par()</code>.
These parameters are listed as follows. Note some parameters can only be
modified before the initialization of the circular layout.</p>
<ul>
<li><code>start.degree</code>: The starting degree where the first sector is put. Note this
degree is measured in the standard polar coordinate system which means it is always
reverse clockwise. E.g. if it is set to 90, sectors start from the top
center of the circle. See Figure <a href="circular-layout.html#fig:circlize-direction">2.5</a>.</li>
<li><code>gap.degree</code>: Gap between two neighbour sectors. It can be a single value
which means all gaps share same degree, or a vector which has same number as
sectors. <strong>Note the first gap is after the first sector.</strong> See Figure
<a href="circular-layout.html#fig:circlize-direction">2.5</a> and Figure <a href="circular-layout.html#fig:circlize-region">2.7</a>.</li>
<li><code>gap.after</code>: Same as <code>gap.degree</code>, but more understandable. Modifying values
of <code>gap.after</code> will also modify <code>gap.degree</code> and vice versa.</li>
<li><code>track.margin</code>: <a href="https://www.w3schools.com/css/css_margin.asp">Like <code>margin</code> in Cascading Style Sheets (CSS)</a>, it is the
blank area out of the plotting region, also outside of the borders. Since
left and right margin are controlled by <code>gap.after</code>, only bottom and top
margin need to be set. The value for <code>track.margin</code> is the percentage to the
radius of the unit circle. The value can also be set by <code>mm_h()</code>/<code>cm_h()</code>/<code>inches_h()</code> functions with absolute units. See Figure
<a href="circular-layout.html#fig:circlize-region">2.7</a>.</li>
<li><code>cell.padding</code>: Padding of the cell. <a href="https://www.w3schools.com/css/css_padding.asp">Like <code>padding</code> in Cascading Style
Sheets (CSS)</a>, it is the blank area around the plotting regions, but within
the borders. The parameter has four values, which control the bottom, left,
top and right padding respectively. The first and the third padding values
are the percentages to the radius of the unit circle, and the second and
fourth values are the degrees. The first and the third value can be set by
<code>mm_h()</code>/<code>cm_h()</code>/<code>inches_h()</code> with absolute units. See Figure <a href="circular-layout.html#fig:circlize-region">2.7</a>.</li>
<li><code>unit.circle.segments</code>: Since curves are simulated by a series of straight
lines, this parameter controls the amount of segments to represent a curve.
The minimal length of the line segment is the length of the unit circle
(<span class="math inline">\(2\pi\)</span>) divided by <code>unit.circle.segments</code>. More segments means better
approximation for the curves, while generate larger file size if figures are
in PDF format. See explanantion in Section <a href="graphics.html#lines">3.3</a>.</li>
<li><code>track.height</code>: The default height of tracks. It is the percentage to the
radius of the unit circle. The height includes the top and bottom cell
paddings but not the margins. The value can be set by
<code>mm_h()</code>/<code>cm_h()</code>/<code>inches_h()</code> with absolute units.</li>
<li><code>points.overflow.warning</code>: Since each cell is in fact not a real plotting
region but only an ordinary rectangle (or more precisely, a circular
rectangle), it does not remove points that are plotted outside of the
region. So if some points (or lines, text) are out of the plotting region,
by default, the package would continue drawing the points but with warning
messages. However, in some circumstances, drawing something out of the
plotting region is useful, such as adding some text annotations (like the
first track in Figure <a href="introduction.html#fig:circlize-glance-track-1">1.2</a>). Set this value to
<code>FALSE</code> to turn off the warnings.</li>
<li><code>canvas.xlim</code>: The ranges in the canvas coordinate in x direction. <strong>circlize</strong> is
forced to put everything inside the unit circle, so <code>canvas.xlim</code> and <code>canvas.ylim</code>
is <code>c(-1, 1)</code> by default. However, you can set it to a more
broad interval if you want to leave more spaces out of the circle. By
choosing proper <code>canvas.xlim</code> and <code>canvas.ylim</code>, actually you can customize
the circle. E.g. setting <code>canvas.xlim</code> to <code>c(0, 1)</code> and <code>canvas.ylim</code> to
<code>c(0, 1)</code> would only draw 1/4 of the circle.</li>
<li><code>canvas.ylim</code>: The ranges in the canvas coordinate in y direction.</li>
<li><code>circle.margin</code>: Margin in the horizontal and vertical direction. The value
should be a positive numeric vector and the length of it should be either 1,
2, or 4. When it has length of 1, it controls the margin on the four sides
of the circle. When it has length of 2, the first value controls the margin
on the left and right, and the second value controls the margin on the
bottom and top side. When it has length of 4, the four values controls the
margins on the left, right, bottom and top sides of the circle. So A value
of <code>c(x1, x2, y1, y2)</code> means <code>circos.par(canvas.xlim = c(-(1+x1), 1+x2),   canvas.ylim = c(-(1+y1), 1+y2))</code>.</li>
<li><code>clock.wise</code>: The order for drawing sectors. Default is <code>TRUE</code> which means
clockwise (Figure <a href="circular-layout.html#fig:circlize-direction">2.5</a>.</li>
<li><code>xaxis.clock.wise</code>: The direction of x-axis in each cell. By default it is clockwise.
Note this new parameter was only available from version 0.4.11 (Figure <a href="circular-layout.html#fig:circlize-axis-direction">2.6</a>).
Also see more details <a href="https://jokergoo.github.io/2020/08/17/reverse-x-axes-in-the-circular-plot/">on this blog post</a>.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circlize-region"></span>
<img src="02-circlize-layout_files/figure-html/circlize-region-1.png" alt="Regions in a cell." width="384" />
<p class="caption">
Figure 2.7: Regions in a cell.
</p>
</div>
<p>Default values for graphic parameters are listed in following table.</p>
<table>
<tbody>
<tr class="odd">
<td align="left"><code>start.degree</code></td>
<td align="left"><code>0</code></td>
</tr>
<tr class="even">
<td align="left"><code>gap.degree</code>/<code>gap.after</code></td>
<td align="left"><code>1</code></td>
</tr>
<tr class="odd">
<td align="left"><code>track.margin</code></td>
<td align="left"><code>c(0.01, 0.01)</code></td>
</tr>
<tr class="even">
<td align="left"><code>cell.padding</code></td>
<td align="left"><code>c(0.02, 1.00, 0.02, 1.00)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>unit.circle.segments</code></td>
<td align="left"><code>500</code></td>
</tr>
<tr class="even">
<td align="left"><code>track.height</code></td>
<td align="left"><code>0.2</code></td>
</tr>
<tr class="odd">
<td align="left"><code>points.overflow.warning</code></td>
<td align="left"><code>TRUE</code></td>
</tr>
<tr class="even">
<td align="left"><code>canvas.xlim</code></td>
<td align="left"><code>c(-1, 1)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>canvas.ylim</code></td>
<td align="left"><code>c(-1, 1)</code></td>
</tr>
<tr class="even">
<td align="left"><code>circle.margin</code></td>
<td align="left"><code>c(0, 0, 0, 0)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>clock.wise</code></td>
<td align="left"><code>TRUE</code></td>
</tr>
<tr class="even">
<td align="left"><code>xaxis.clock.wise</code></td>
<td align="left"><code>TRUE</code></td>
</tr>
</tbody>
</table>
<p>Parameters related to the allocation of sectors cannot be changed after the
initialization of the circular layout. Thus, <code>start.degree</code>,
<code>gap.degree</code>/<code>gap.after</code>, <code>canvas.xlim</code>, <code>canvas.ylim</code>, <code>circle.margin</code>, <code>clock.wise</code> and <code>xaxis.clock.wise</code> can
only be modified before <code>circos.initialize()</code>. The second and the fourth
values of <code>cell.padding</code> (left and right paddings) can not be modified neither
(or will be ignored).</p>
<p>Similar reason, since some of the parameters are defined before the initialization
of the circular layout, after making each plot, you need to call <code>circos.clear()</code>
to manually reset all the parameters.</p>
<p><code>circos.par()</code> can be used in the same way as <code>options()</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="circular-layout.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;start.degree&quot;</span> <span class="ot">=</span> <span class="dv">30</span>)</span></code></pre></div>
<p>Or use the <code>$</code> symbol:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="circular-layout.html#cb21-1" aria-hidden="true" tabindex="-1"></a>circos.par<span class="sc">$</span>start.degree <span class="ot">=</span> <span class="dv">30</span></span></code></pre></div>
<p>Use <code>RESET</code> to reset all the options to their default values:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="circular-layout.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">RESET =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Simply enter <code>circos.par</code> prints the current values of all parameters:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="circular-layout.html#cb23-1" aria-hidden="true" tabindex="-1"></a>circos.par</span></code></pre></div>
<pre><code>##  Option                  Value           
##  -----------------------:------------------
##  start.degree            0               
##  gap.degree              1               
##  gap.after               1               
##  track.margin            0.01, 0.01      
##  unit.circle.segments    500             
##  cell.padding            0.02, 1, 0.02, 1
##  track.height            0.2             
##  points.overflow.warning TRUE            
##  circle.margin           0, 0, 0, 0      
##  canvas.xlim             -1, 1           
##  canvas.ylim             -1, 1           
##  major.by.degree         10              
##  clock.wise              TRUE            
##  xaxis.clock.wise        TRUE            
##  message                 TRUE            
##  help                    TRUE</code></pre>
<p><code>circos.par()</code> is aimed to be designed to be independent to the number or the
order of sectors, however, there is an exception. The <code>gap.degree</code>/<code>gap.after</code> parameter
controls the spaces between two neighbouring sectors. When it is set as a
scalar, the gap is the same to every two neighbouring sectors and it works
fine. It can also be a vector which has the same length as the number of
sectors and it can cause problems:</p>
<ol style="list-style-type: decimal">
<li>When you change the order of the sectors, you also need to manually change
the order of <code>gap.degree</code>/<code>gap.after</code>.</li>
<li>In <code>chordDiagram()</code> function which will be introduced in Section <a href="the-chorddiagram-function.html#the-chorddiagram-function">14</a>, by
default the tiny sectors are removed to improve the visualization, which
means, the gap.degree should be adjusted.</li>
<li>Also in <code>chordDiagram()</code>,
sometimes it is not very straightforward to find out the order of sectors,
thus, it is difficult to set a proper <code>gap.degree</code>/<code>gap.after</code>.</li>
</ol>
<p>Now, from version 0.4.10, the value of <code>gap.degree</code>/<code>gap.after</code> can be set as a
named vector where the names are the names of the sectors. In this case, the
<code>gap.degree</code>/<code>gap.after</code> vector can be automatically reordered or subsetted according to the
sector ordering in the plot.</p>
</div>
<div id="create-plotting-regions" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Create plotting regions</h2>
<p>As described above, only after creating the plotting region can you add low-level
graphics in it. The minimal set of arguments for <code>circos.track()</code> is to set
either <code>y</code> or <code>ylim</code> which assigns range of y values for this track.
<code>circos.track()</code> creates tracks for all sectors although in some case only
parts of them are visible.</p>
<p>If <code>sectors</code> is not specified, all cells in the track will be created with the
same settings. If <code>sectors</code>, <code>x</code> and <code>y</code> are set, they need to be vectors with
the same length. Proper values of <code>x</code> and <code>y</code> that correspond to current cell
will be passed to <code>panel.fun</code> by subsetting <code>sectors</code> internally. Section
<a href="circular-layout.html#panel-fun">2.7</a> explains the usage of <code>panel.fun</code>.</p>
<p>Graphic arguments such as <code>bg.border</code> and <code>bg.col</code> can either be a scalar or a
vector. If it is a vector, the length must be equal to the number of sectors and the order
corresponds to the order of sectors.
Thus, you can create plot regions with different styles of borders and
background colors.</p>
<p>If you are confused with the <code>sectors</code> orders, you can also customize the
borders and background colors inside <code>panel.fun</code>.
<code>get.cell.meta.data("cell.xlim")</code>/<code>CELL_META$cell.xlim</code> and
<code>get.cell.meta.data("cell.ylim")</code>/<code>CELL_META$cell.ylim</code> give you dimensions of
the plotting region and you can customize plot regions directly by e.g.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="circular-layout.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.rect</span>(CELL_META<span class="sc">$</span>cell.xlim[<span class="dv">1</span>], CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">1</span>],</span>
<span id="cb25-2"><a href="circular-layout.html#cb25-2" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.xlim[<span class="dv">2</span>], CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>], </span>
<span id="cb25-3"><a href="circular-layout.html#cb25-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;#FF000040&quot;</span>, <span class="at">border =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><code>circos.track()</code> provides <code>track.margin</code> and <code>cell.padding</code> arguments that
they only control track margins and cell paddings for the current track. Of course
the second and fourth value (the left and the right padding) in <code>cell.padding</code> are ignored.</p>
</div>
<div id="update-plotting-regions" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Update plotting regions</h2>
<p><code>circos.track()</code> creates new tracks, however, if <code>track.index</code> argument is set
to a track which already exists, <code>circos.track()</code> actually <strong>re-creates</strong> this
track. In this case, coordinates on y directions can be re-defined, but
settings related to the positions of the track such as the height of the track
can not be modified.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="circular-layout.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(sectors, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">track.index =</span> <span class="dv">1</span>, ...)</span></code></pre></div>
<p>For a single cell, <code>circos.update()</code> can be used to erase all graphics that
have been already added in the cell. However, the data coordinate in the cell
keeps unchanged.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="circular-layout.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.update</span>(sector.index, track.index)</span>
<span id="cb27-2"><a href="circular-layout.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.points</span>(x, y, sector.index, track.index)</span></code></pre></div>
</div>
<div id="panel-fun" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> <code>panel.fun</code> argument</h2>
<p>The <code>panel.fun</code> argument in <code>circos.track()</code> is extremely useful to apply plotting
as soon as the cell has been created. This self-defined function needs two
arguments <code>x</code> and <code>y</code> which are data points that belong to this cell. The
value for <code>x</code> and <code>y</code> are automatically extracted from <code>x</code> and <code>y</code> in
<code>circos.track()</code> according to the category defined in <code>sectors</code>. In the
following example, inside <code>panel.fun</code>, in sector <code>a</code>, the value of <code>x</code> is
<code>1:3</code> and in sector <code>b</code>, value of <code>x</code> is <code>4:5</code>. If <code>x</code> or <code>y</code> in
<code>circos.track()</code> is <code>NULL</code>, then <code>x</code> or <code>y</code> inside <code>panel.fun</code> is also <code>NULL</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="circular-layout.html#cb28-1" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>)</span>
<span id="cb28-2"><a href="circular-layout.html#cb28-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb28-3"><a href="circular-layout.html#cb28-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb28-4"><a href="circular-layout.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(sectors, <span class="at">x =</span> x, <span class="at">y =</span> y,</span>
<span id="cb28-5"><a href="circular-layout.html#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb28-6"><a href="circular-layout.html#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.points</span>(x, y)</span>
<span id="cb28-7"><a href="circular-layout.html#cb28-7" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Since you can obtain the current sector index in <code>panel.fun</code>, you can ignore the values
from the <code>x</code> and <code>y</code> arguments, while do subsetting by your own:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="circular-layout.html#cb29-1" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>)</span>
<span id="cb29-2"><a href="circular-layout.html#cb29-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb29-3"><a href="circular-layout.html#cb29-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">=</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb29-4"><a href="circular-layout.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">range</span>(y),</span>
<span id="cb29-5"><a href="circular-layout.html#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) { <span class="co"># here x and y are useless</span></span>
<span id="cb29-6"><a href="circular-layout.html#cb29-6" aria-hidden="true" tabindex="-1"></a>        l <span class="ot">=</span> sectors <span class="sc">==</span> CELL_META<span class="sc">$</span>sector.index</span>
<span id="cb29-7"><a href="circular-layout.html#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.points</span>(x2[l], y2[l])</span>
<span id="cb29-8"><a href="circular-layout.html#cb29-8" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>In <code>panel.fun</code>, one thing important is that if you use any low-level graphic
functions, you don’t need to specify <code>sector.index</code> and <code>track.index</code>
explicitly. Remember that when applying <code>circos.track()</code>, cells in the track
are created one after one. When a cell is created, <strong>circlize</strong> would set the
sector index and track index of the cell as the ‘current’ index. When the cell
is created, <code>panel.fun</code> is executed immediately. Without specifying
<code>sector.index</code> and <code>track.index</code>, the ‘current’ ones are used and that’s
exactly what you need.</p>
<p>The advantage of <code>panel.fun</code> is that it makes you feel you are using graphic
functions in the base graphic engine (You can see it is almost the same of
using <code>circos.points(x, y)</code> and <code>points(x, y)</code>). It will be much easier for
users to understand and customize new graphics.</p>
<p>Inside <code>panel.fun</code>, information of the ‘current’ cell can be obtained through
<code>get.cell.meta.data()</code>. Also this function takes the ‘current’ sector and
‘current’ track by default.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="circular-layout.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get.cell.meta.data</span>(name)</span>
<span id="cb30-2"><a href="circular-layout.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get.cell.meta.data</span>(name, sector.index, track.index)</span></code></pre></div>
<p>Information that can be extracted by <code>get.cell.meta.data()</code> are:</p>
<ul>
<li><code>sector.index</code>: The name for the sector.</li>
<li><code>sector.numeric.index</code>: Numeric index for the sector.</li>
<li><code>track.index</code>: Numeric index for the track.</li>
<li><code>xlim</code>: Minimal and maximal values on the x-axis.</li>
<li><code>ylim</code>: Minimal and maximal values on the y-axis.</li>
<li><code>xcenter</code>: mean of <code>xlim</code>.</li>
<li><code>ycenter</code>: mean of <code>ylim</code>.</li>
<li><code>xrange</code>: defined as <code>xlim[2] - xlim[1]</code>.</li>
<li><code>yrange</code>: defined as <code>ylim[2] - ylim[1]</code>.</li>
<li><code>cell.xlim</code>: Minimal and maximal values on the x-axis extended by cell
paddings.</li>
<li><code>cell.ylim</code>: Minimal and maximal values on the y-axis extended by cell
paddings.</li>
<li><code>xplot</code>: Degree of right and left borders in the plotting region. The values ignore the direction of the circular layout (i.e. whether it is clock wise or not). <code>xplot[1]</code> is always upstream of <code>xplot[2]</code> in the clock-wise direction.</li>
<li><code>yplot</code>: Radius of bottom and top radius in the plotting region.</li>
<li><code>cell.width</code>: Width of the cell, measured in degree. It is calculated as <code>(xplot[1] - xplot[2]) %% 360</code>.</li>
<li><code>cell.height</code>: Height of the cell. Simply <code>yplot[2] - yplot[1]</code>.</li>
<li><code>cell.start.degree</code>: Same as <code>xplot[1]</code>.</li>
<li><code>cell.end.degree</code>: Same as <code>xplot[2]</code>.</li>
<li><code>cell.bottom.radius</code>: Same as <code>yplot[1]</code>.</li>
<li><code>cell.top.radius</code>: Same as <code>yplot[2]</code>.</li>
<li><code>track.margin</code>: Margins of the cell.</li>
<li><code>cell.padding</code>: Paddings of the cell.</li>
</ul>
<p>Following example code uses <code>get.cell.meta.data()</code> to add sector index in the
center of each cell.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="circular-layout.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> ylim, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb31-2"><a href="circular-layout.html#cb31-2" aria-hidden="true" tabindex="-1"></a>    sector.index <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.index&quot;</span>)</span>
<span id="cb31-3"><a href="circular-layout.html#cb31-3" aria-hidden="true" tabindex="-1"></a>    xcenter <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;xcenter&quot;</span>)</span>
<span id="cb31-4"><a href="circular-layout.html#cb31-4" aria-hidden="true" tabindex="-1"></a>    ycenter <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;ycenter&quot;</span>)</span>
<span id="cb31-5"><a href="circular-layout.html#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.text</span>(xcenter, ycenter, sector.index)</span>
<span id="cb31-6"><a href="circular-layout.html#cb31-6" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><code>get.cell.meta.data()</code> can also be used outside <code>panel.fun</code>, but you need to
explictly specify <code>sector.index</code> and <code>track.index</code> arguments unless the current
index is what you want.</p>
<p>There is a companion variable <code>CELL_META</code> which is identical to
<code>get.cell.meta.data()</code> to get cell meta information, but easier and shorter to
write. Actually, the value of <code>CELL_META</code> itself is meaningless, but e.g.
<code>CELL_META$sector.index</code> is automatically redirected to
<code>get.cell.meta.data("sector.index")</code>. Following code rewrites previous example
code with <code>CELL_META</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="circular-layout.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> ylim, <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb32-2"><a href="circular-layout.html#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>ycenter, </span>
<span id="cb32-3"><a href="circular-layout.html#cb32-3" aria-hidden="true" tabindex="-1"></a>        CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb32-4"><a href="circular-layout.html#cb32-4" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Please note <code>CELL_META</code> only extracts information for the “current” cell, thus,
it is recommended to use only in <code>panel.fun</code>.</p>
<p>Nevertheless, if you have several lines of code which need to be executed out of <code>panel.fun</code>,
you can flag the specified cell as the “current” cell by <code>set.current.cell()</code>, which can save you from typing
too many <code>sector.index = ..., track.index = ...</code>. E.g. following code</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="circular-layout.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="fu">get.cell.meta.data</span>(<span class="st">&quot;xcenter&quot;</span>, sector.index, track.index),</span>
<span id="cb33-2"><a href="circular-layout.html#cb33-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;ycenter&quot;</span>, sector.index, track.index),</span>
<span id="cb33-3"><a href="circular-layout.html#cb33-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.index&quot;</span>, sector.index, track.index),</span>
<span id="cb33-4"><a href="circular-layout.html#cb33-4" aria-hidden="true" tabindex="-1"></a>            sector.index, track.index)</span></code></pre></div>
<p>can be simplified to:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="circular-layout.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.current.cell</span>(sector.index, track.index)</span>
<span id="cb34-2"><a href="circular-layout.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="fu">get.cell.meta.data</span>(<span class="st">&quot;xcenter&quot;</span>),</span>
<span id="cb34-3"><a href="circular-layout.html#cb34-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;ycenter&quot;</span>),</span>
<span id="cb34-4"><a href="circular-layout.html#cb34-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;sector.index&quot;</span>))</span>
<span id="cb34-5"><a href="circular-layout.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># or even simpler</span></span>
<span id="cb34-6"><a href="circular-layout.html#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>ycenter, CELL_META<span class="sc">$</span>sector.index)</span></code></pre></div>
</div>
<div id="other-utilities" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Other utilities</h2>
<div id="circlize_and_reverse_circlize" class="section level3" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> <code>circlize()</code> and <code>reverse.circlize()</code></h3>
<p><strong>circlize</strong> transforms data points in several coordinate systems and it is
basically done by the core function <code>circlize()</code>. The function transforms from data
coordinate (coordinate in the cell) to the polar coordinate and its companion
<code>reverse.circlize()</code> transforms from polar coordinate to a specified data coordinate. The
default transformation is applied in the <code>current</code> cell.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="circular-layout.html#cb35-1" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)</span>
<span id="cb35-2"><a href="circular-layout.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb35-3"><a href="circular-layout.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb35-4"><a href="circular-layout.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># x = 0.5, y = 0.5 in sector a and track 1</span></span>
<span id="cb35-5"><a href="circular-layout.html#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">circlize</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="at">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##      theta  rou
## [1,] 270.5 0.89</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="circular-layout.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theta = 90, rou = 0.9 in the polar coordinate</span></span>
<span id="cb37-2"><a href="circular-layout.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">reverse.circlize</span>(<span class="dv">90</span>, <span class="fl">0.9</span>, <span class="at">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##             x    y
## [1,] 1.519774 0.56</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="circular-layout.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reverse.circlize</span>(<span class="dv">90</span>, <span class="fl">0.9</span>, <span class="at">sector.index =</span> <span class="st">&quot;b&quot;</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##              x    y
## [1,] 0.5028249 0.56</code></pre>
<p>You can see the results are different for two <code>reverse.circlize()</code>
although it is the same points in the polar coordinate, because they are
mapped to different cells.</p>
<p><code>circlize()</code> and <code>reverse.circlize()</code> can be used to connect two circular
plots if they are drawn on a same page. This provides a way to build more
complex plots. Basically, the two circular plots share a same polar
coordiante, then, the manipulation of <code>circlize-&gt;reverse.circlize-&gt;circlize</code>
can transform coordinate for data points from the first circular plot to the
second. In Chapter <a href="nested-zooming.html#nested-zooming">13</a>, we use this technique to combine two
circular plots where one zooms subset of regions in the other one.</p>
<p>The transformation between polar coordinate and canvas coordinate is simple.
<strong>circlize</strong> has a <code>circlize:::polar2Cartesian()</code> function but this function
is not exported.</p>
<p>Following example (Figure <a href="circular-layout.html#fig:circular-pokemon">2.8</a>) adds raster image to the circular plot. The raster image is added
by <code>rasterImage()</code> which is applied in the canvas coordinate. Note how we change
coordinate from data coordinate to canvas coordinate by using <code>circlize()</code>
and <code>circlize:::polar2Cartesian()</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="circular-layout.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yaml)</span>
<span id="cb41-2"><a href="circular-layout.html#cb41-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">yaml.load_file</span>(<span class="st">&quot;https://raw.githubusercontent.com/Templarian/slack-emoji-pokemon/master/pokemon.yaml&quot;</span>)</span>
<span id="cb41-3"><a href="circular-layout.html#cb41-3" aria-hidden="true" tabindex="-1"></a>pokemon_list <span class="ot">=</span> data<span class="sc">$</span>emojis[<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>]</span>
<span id="cb41-4"><a href="circular-layout.html#cb41-4" aria-hidden="true" tabindex="-1"></a>pokemon_name <span class="ot">=</span> <span class="fu">sapply</span>(pokemon_list, <span class="cf">function</span>(x) x<span class="sc">$</span>name)</span>
<span id="cb41-5"><a href="circular-layout.html#cb41-5" aria-hidden="true" tabindex="-1"></a>pokemon_src <span class="ot">=</span> <span class="fu">sapply</span>(pokemon_list, <span class="cf">function</span>(x) x<span class="sc">$</span>src)</span>
<span id="cb41-6"><a href="circular-layout.html#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="circular-layout.html#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EBImage)</span>
<span id="cb41-8"><a href="circular-layout.html#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">&quot;points.overflow.warning&quot;</span> <span class="ot">=</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-9"><a href="circular-layout.html#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(pokemon_name, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb41-10"><a href="circular-layout.html#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb41-11"><a href="circular-layout.html#cb41-11" aria-hidden="true" tabindex="-1"></a>    pos <span class="ot">=</span> circlize<span class="sc">:::</span><span class="fu">polar2Cartesian</span>(<span class="fu">circlize</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>ycenter))</span>
<span id="cb41-12"><a href="circular-layout.html#cb41-12" aria-hidden="true" tabindex="-1"></a>    image <span class="ot">=</span> EBImage<span class="sc">::</span><span class="fu">readImage</span>(pokemon_src[CELL_META<span class="sc">$</span>sector.numeric.index])</span>
<span id="cb41-13"><a href="circular-layout.html#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mm_y</span>(<span class="dv">2</span>),</span>
<span id="cb41-14"><a href="circular-layout.html#cb41-14" aria-hidden="true" tabindex="-1"></a>        CELL_META<span class="sc">$</span>sector.index, <span class="at">facing =</span> <span class="st">&quot;clockwise&quot;</span>, <span class="at">niceFacing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-15"><a href="circular-layout.html#cb41-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>), <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb41-16"><a href="circular-layout.html#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rasterImage</span>(image, </span>
<span id="cb41-17"><a href="circular-layout.html#cb41-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">xleft =</span> pos[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">ybottom =</span> pos[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.05</span>,</span>
<span id="cb41-18"><a href="circular-layout.html#cb41-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">xright =</span> pos[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">ytop =</span> pos[<span class="dv">1</span>, <span class="dv">2</span>]<span class="sc">+</span> <span class="fl">0.05</span>)</span>
<span id="cb41-19"><a href="circular-layout.html#cb41-19" aria-hidden="true" tabindex="-1"></a>}, <span class="at">bg.border =</span> <span class="dv">1</span>, <span class="at">track.height =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:circular-pokemon"></span>
<img src="02-circlize-layout_files/figure-html/circular-pokemon-1.png" alt="Add raster image to the circular plot." width="576" />
<p class="caption">
Figure 2.8: Add raster image to the circular plot.
</p>
</div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="circular-layout.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
<p>In <strong>circlize</strong> package, there is a <code>circos.raster()</code> function which directly
adds raster images. It is introduced in Section <a href="graphics.html#raster-image">3.11</a>.</p>
</div>
<div id="convert-functions" class="section level3" number="2.8.2">
<h3><span class="header-section-number">2.8.2</span> Absolute units</h3>
<p>For the functions in <strong>circlize</strong> package, they needs arguments which are
lengths measured either in the canvas coordinate or in the data coordinate.
E.g. <code>track.height</code> argument in <code>circos.track()</code> corresponds to percent of
radius of the unit circle. <strong>circlize</strong> package is built in the R base graphic
system which is not straightforward to define a length with absolute units
(e.g. a line of length 2 cm). To solve this problem, <strong>circlize</strong> provides
several functions which convert absolute units to the canvas coordinate or the
data coordinate accordingly.</p>
<p><code>mm_h()</code>, <code>cm_h()</code>, <code>inches_h()</code>/<code>inch_h()</code> functions convert absolute units
to the canvas coordinate in the radical direction, which normally define the
heights of e.g. tracks. If users want to convert a string height or width to
the canvas coordinate, directly use <code>strheight()</code> or <code>strwidth()</code> functions.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="circular-layout.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mm_h</span>(<span class="dv">2</span>) <span class="co"># 2mm</span></span>
<span id="cb43-2"><a href="circular-layout.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cm_h</span>(<span class="dv">1</span>) <span class="co"># 1cm</span></span></code></pre></div>
<p><code>mm_x()</code>, <code>cm_x()</code>, <code>inches_x()</code>/<code>inch_x()</code>, <code>mm_y()</code>, <code>cm_y()</code>,
<code>inches_y()</code>/<code>inch_y()</code> convert absolute units to the data coordinate in the x
or y direction. By default, the conversion is applied in the “current” cell,
but it can still be used in other cells by specifying <code>sector.index</code> and
<code>track.index</code> arguments.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="circular-layout.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mm_x</span>(<span class="dv">2</span>)</span>
<span id="cb44-2"><a href="circular-layout.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mm_x</span>(<span class="dv">1</span>, sector.index, track.index)</span>
<span id="cb44-3"><a href="circular-layout.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mm_y</span>(<span class="dv">2</span>)</span>
<span id="cb44-4"><a href="circular-layout.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mm_y</span>(<span class="dv">1</span>, sector.index, track.index)</span></code></pre></div>
<p>Since the width of the cell is not identical from the top to the bottom in the
cell, for <code>*_x()</code> function, the position on y direction where the convert is
applied can be specified by the <code>h</code> argument (measured in data coordinate). By
default it is converted at the middle point on y-axis.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="circular-layout.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mm_x</span>(<span class="dv">2</span>, h)</span></code></pre></div>
<p>Normally the difference of e.g. <code>mm_x(2)</code> at different y positions in a track
is very small (unless the track has very big <code>track.height</code>), so in most
cases, you can ignore the setting of <code>h</code> argument.</p>
<p>Following plot (Figure <a href="circular-layout.html#fig:unit-convert">2.9</a>) is an example of setting absolute units.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="circular-layout.html#cb46-1" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb46-2"><a href="circular-layout.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">track.margin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb46-3"><a href="circular-layout.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, <span class="at">xlim =</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="fu">runif</span>(<span class="dv">10</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>)))</span>
<span id="cb46-4"><a href="circular-layout.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">track.height =</span> <span class="fu">mm_h</span>(<span class="dv">5</span>),</span>
<span id="cb46-5"><a href="circular-layout.html#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb46-6"><a href="circular-layout.html#cb46-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span> <span class="sc">+</span> <span class="fu">mm_x</span>(<span class="dv">5</span>)), <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb46-7"><a href="circular-layout.html#cb46-7" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb46-8"><a href="circular-layout.html#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">track.height =</span> <span class="fu">cm_h</span>(<span class="dv">1</span>),</span>
<span id="cb46-9"><a href="circular-layout.html#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">track.margin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">mm_h</span>(<span class="dv">2</span>)),</span>
<span id="cb46-10"><a href="circular-layout.html#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb46-11"><a href="circular-layout.html#cb46-11" aria-hidden="true" tabindex="-1"></a>        xcenter <span class="ot">=</span> <span class="fu">get.cell.meta.data</span>(<span class="st">&quot;xcenter&quot;</span>)</span>
<span id="cb46-12"><a href="circular-layout.html#cb46-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(<span class="fu">c</span>(xcenter, xcenter), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cm_y</span>(<span class="dv">1</span>)), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb46-13"><a href="circular-layout.html#cb46-13" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb46-14"><a href="circular-layout.html#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">track.height =</span> <span class="fu">inch_h</span>(<span class="dv">1</span>),</span>
<span id="cb46-15"><a href="circular-layout.html#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">track.margin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">mm_h</span>(<span class="dv">5</span>)),</span>
<span id="cb46-16"><a href="circular-layout.html#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb46-17"><a href="circular-layout.html#cb46-17" aria-hidden="true" tabindex="-1"></a>        line_length_on_x <span class="ot">=</span> <span class="fu">cm_x</span>(<span class="dv">1</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb46-18"><a href="circular-layout.html#cb46-18" aria-hidden="true" tabindex="-1"></a>        line_length_on_y <span class="ot">=</span> <span class="fu">cm_y</span>(<span class="dv">1</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb46-19"><a href="circular-layout.html#cb46-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, line_length_on_x), <span class="fu">c</span>(<span class="dv">0</span>, line_length_on_y), <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb46-20"><a href="circular-layout.html#cb46-20" aria-hidden="true" tabindex="-1"></a>    })</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unit-convert"></span>
<img src="02-circlize-layout_files/figure-html/unit-convert-1.png" alt="Setting absolute units" width="576" />
<p class="caption">
Figure 2.9: Setting absolute units
</p>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="circular-layout.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
</div>
<div id="circos-info-and-circos-clear" class="section level3" number="2.8.3">
<h3><span class="header-section-number">2.8.3</span> <code>circos.info()</code> and <code>circos.clear()</code></h3>
<p>You can get basic information of your current circular plot by
<code>circos.info()</code>. The function can be called at any time.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="circular-layout.html#cb48-1" aria-hidden="true" tabindex="-1"></a>sectors <span class="ot">=</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb48-2"><a href="circular-layout.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(sectors, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb48-3"><a href="circular-layout.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.info</span>()</span></code></pre></div>
<pre><code>## All your sectors:
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;
## 
## No track has been created
## 
## Your current sector.index is a</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="circular-layout.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb50-2"><a href="circular-layout.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.info</span>(<span class="at">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## sector index: &#39;a&#39;
## track index: 1
## xlim: [1, 2]
## ylim: [0, 1]
## cell.xlim: [0.991453, 2.008547]
## cell.ylim: [-0.1, 1.1]
## xplot (degree): [360, 241]
## yplot (radius): [0.79, 0.99]
## cell.width (degree): 119
## cell.height (radius): 0.2
## track.margin: c(0.01, 0.01)
## cell.padding: c(0.02, 1, 0.02, 1)
## 
## Your current sector.index is c
## Your current track.index is 1</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="circular-layout.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>
<p>It can also add labels to all cells by <code>circos.info(plot = TRUE)</code>.</p>
<p>You should always call <code>circos.clear()</code> at the end of every circular plot.
There are several parameters for circular plot which can only be set before
<code>circos.initialize()</code>, thus, before you draw the next circular plot, you need
to reset all these parameters.</p>
</div>
</div>
<div id="set-gaps-between-tracks" class="section level2" number="2.9">
<h2><span class="header-section-number">2.9</span> Set gaps between tracks</h2>
<p>In the older versions, you need to set <code>track.height</code> parameter either in
<code>circos.par()</code> or in <code>circos.track()</code> to control the space between tracks. Now
there is a new <code>set_track_gap()</code> function which simplifies the setting of gaps
between two tracks. With the <code>mm_h()</code>/<code>cm_h()</code>/<code>inch_h()</code> functions, it is very easy
to set the gaps with physical units (Figure <a href="circular-layout.html#fig:set-track-gap">2.10</a>).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="circular-layout.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb53-2"><a href="circular-layout.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb53-3"><a href="circular-layout.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set_track_gap</span>(<span class="fu">mm_h</span>(<span class="dv">2</span>)) <span class="co"># 2mm</span></span>
<span id="cb53-4"><a href="circular-layout.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb53-5"><a href="circular-layout.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set_track_gap</span>(<span class="fu">cm_h</span>(<span class="fl">0.5</span>)) <span class="co"># 0.5cm</span></span>
<span id="cb53-6"><a href="circular-layout.html#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:set-track-gap"></span>
<img src="02-circlize-layout_files/figure-html/set-track-gap-1.png" alt="Setting gaps between tracks." width="576" />
<p class="caption">
Figure 2.10: Setting gaps between tracks.
</p>
</div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="circular-layout.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jokergoo/circlize_book/edit/master/02-circlize-layout.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
